[HCTR][17:08:09.878][ERROR][RK0][main]: using mock embedding with 800000000 * 128 elements
[HCTR][17:08:09.882][ERROR][RK0][main]: using mock embedding with 800000000 * 128 elements
[HCTR][17:08:09.882][ERROR][RK0][main]: using mock embedding with 800000000 * 128 elements
[HCTR][17:08:09.894][ERROR][RK0][main]: using mock embedding with 800000000 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:01,  1.74s/it]warmup run: 102it [00:01, 77.06it/s]warmup run: 208it [00:01, 173.02it/s]warmup run: 312it [00:02, 278.97it/s]warmup run: 416it [00:02, 392.11it/s]warmup run: 511it [00:02, 402.85it/s]warmup run: 588it [00:02, 330.88it/s]warmup run: 648it [00:02, 365.30it/s]warmup run: 738it [00:02, 456.71it/s]warmup run: 847it [00:03, 580.65it/s]warmup run: 957it [00:03, 693.77it/s]warmup run: 1067it [00:03, 789.94it/s]warmup run: 1178it [00:03, 870.03it/s]warmup run: 1283it [00:03, 916.83it/s]warmup run: 1389it [00:03, 956.03it/s]warmup run: 1495it [00:03, 984.01it/s]warmup run: 1599it [00:03, 998.99it/s]warmup run: 1705it [00:03, 1016.06it/s]warmup run: 1812it [00:03, 1030.08it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1917it [00:04, 946.43it/s] warmup run: 2028it [00:04, 989.63it/s]warmup run: 2136it [00:04, 1014.83it/s]warmup run: 2249it [00:04, 1047.45it/s]warmup run: 2364it [00:04, 1073.63it/s]warmup run: 2473it [00:04, 1024.92it/s]warmup run: 0it [00:00, ?it/s]warmup run: 2587it [00:04, 1056.13it/s]warmup run: 2697it [00:04, 1066.72it/s]warmup run: 2806it [00:04, 1073.24it/s]warmup run: 2915it [00:04, 1076.79it/s]warmup run: 3025it [00:05, 1083.10it/s]warmup run: 3162it [00:05, 1165.87it/s]warmup run: 1it [00:01,  1.28s/it]warmup run: 3279it [00:05, 1085.38it/s]warmup run: 0it [00:00, ?it/s]warmup run: 110it [00:01, 110.08it/s]warmup run: 3415it [00:05, 1162.68it/s]warmup run: 219it [00:01, 232.71it/s]warmup run: 3550it [00:05, 1214.56it/s]warmup run: 329it [00:01, 364.06it/s]warmup run: 3684it [00:05, 1250.95it/s]warmup run: 436it [00:01, 489.59it/s]warmup run: 3817it [00:05, 1273.87it/s]warmup run: 546it [00:01, 613.05it/s]warmup run: 3952it [00:05, 1294.43it/s]warmup run: 1it [00:01,  1.26s/it]warmup run: 4000it [00:05, 684.21it/s] warmup run: 653it [00:01, 715.42it/s]warmup run: 97it [00:01, 98.25it/s]warmup run: 758it [00:01, 795.62it/s]warmup run: 191it [00:01, 204.69it/s]warmup run: 864it [00:02, 862.34it/s]warmup run: 291it [00:01, 326.24it/s]warmup run: 970it [00:02, 914.28it/s]warmup run: 396it [00:01, 455.68it/s]warmup run: 1076it [00:02, 953.99it/s]warmup run: 499it [00:01, 571.95it/s]warmup run: 1184it [00:02, 989.41it/s]warmup run: 594it [00:01, 653.09it/s]warmup run: 1297it [00:02, 1029.16it/s]warmup run: 702it [00:01, 755.14it/s]warmup run: 1it [00:01,  1.27s/it]warmup run: 1411it [00:02, 1061.07it/s]warmup run: 806it [00:02, 826.72it/s]warmup run: 105it [00:01, 106.21it/s]warmup run: 1524it [00:02, 1080.71it/s]warmup run: 912it [00:02, 887.93it/s]warmup run: 211it [00:01, 226.82it/s]warmup run: 1636it [00:02, 1092.18it/s]warmup run: 1015it [00:02, 926.44it/s]warmup run: 317it [00:01, 353.85it/s]warmup run: 1748it [00:02, 1099.80it/s]warmup run: 1117it [00:02, 948.02it/s]warmup run: 422it [00:01, 478.35it/s]warmup run: 1860it [00:02, 1105.30it/s]warmup run: 1219it [00:02, 964.51it/s]warmup run: 527it [00:01, 593.68it/s]warmup run: 1972it [00:03, 1095.97it/s]warmup run: 1325it [00:02, 990.91it/s]warmup run: 633it [00:01, 697.44it/s]warmup run: 2083it [00:03, 1081.91it/s]warmup run: 1431it [00:02, 1008.89it/s]warmup run: 738it [00:01, 781.54it/s]warmup run: 2192it [00:03, 1079.46it/s]warmup run: 1535it [00:02, 1009.70it/s]warmup run: 844it [00:02, 851.67it/s]warmup run: 2301it [00:03, 1076.00it/s]warmup run: 1640it [00:02, 1020.79it/s]warmup run: 951it [00:02, 908.73it/s]warmup run: 2409it [00:03, 1072.19it/s]warmup run: 1745it [00:02, 1028.84it/s]warmup run: 1057it [00:02, 949.38it/s]warmup run: 2517it [00:03, 1058.43it/s]warmup run: 1849it [00:03, 1014.72it/s]warmup run: 1164it [00:02, 983.08it/s]warmup run: 2623it [00:03, 1051.91it/s]warmup run: 1952it [00:03, 1010.02it/s]warmup run: 1270it [00:02, 999.42it/s]warmup run: 2729it [00:03, 1041.08it/s]warmup run: 2054it [00:03, 997.54it/s] warmup run: 1375it [00:02, 994.76it/s]warmup run: 2834it [00:03, 1041.74it/s]warmup run: 2156it [00:03, 1003.94it/s]warmup run: 1478it [00:02, 998.67it/s]warmup run: 2939it [00:04, 1037.95it/s]warmup run: 2257it [00:03, 997.25it/s] warmup run: 1581it [00:02, 1004.00it/s]warmup run: 3055it [00:04, 1072.68it/s]warmup run: 2357it [00:03, 996.81it/s]warmup run: 1686it [00:02, 1015.97it/s]warmup run: 3187it [00:04, 1143.79it/s]warmup run: 2457it [00:03, 994.43it/s]warmup run: 1791it [00:02, 1025.66it/s]warmup run: 3317it [00:04, 1190.02it/s]warmup run: 2563it [00:03, 1011.64it/s]warmup run: 1899it [00:03, 1040.02it/s]warmup run: 3449it [00:04, 1227.55it/s]warmup run: 2665it [00:03, 1011.09it/s]warmup run: 2005it [00:03, 1045.54it/s]warmup run: 3580it [00:04, 1250.22it/s]warmup run: 2769it [00:04, 1017.13it/s]warmup run: 2110it [00:03, 1046.16it/s]warmup run: 3710it [00:04, 1263.87it/s]warmup run: 2871it [00:04, 1015.23it/s]warmup run: 2215it [00:03, 1042.21it/s]warmup run: 3841it [00:04, 1276.19it/s]warmup run: 2975it [00:04, 1022.46it/s]warmup run: 2320it [00:03, 1011.78it/s]warmup run: 3972it [00:04, 1284.29it/s]warmup run: 4000it [00:04, 825.16it/s] warmup run: 3099it [00:04, 1085.91it/s]warmup run: 2424it [00:03, 1019.08it/s]warmup run: 3226it [00:04, 1140.59it/s]warmup run: 2530it [00:03, 1029.32it/s]warmup run: 3351it [00:04, 1172.19it/s]warmup run: 2634it [00:03, 1003.68it/s]warmup run: 3480it [00:04, 1206.54it/s]warmup run: 2735it [00:03, 1001.41it/s]warmup run: 3610it [00:04, 1233.47it/s]warmup run: 2836it [00:04, 979.69it/s] warmup run: 3739it [00:04, 1249.81it/s]warmup run: 2943it [00:04, 1005.17it/s]warmup run: 3872it [00:04, 1273.20it/s]warmup run: 3055it [00:04, 1036.73it/s]warmup run: 4000it [00:05, 798.81it/s] warmup run: 3178it [00:04, 1093.52it/s]warmup run: 3311it [00:04, 1163.13it/s]warmup run: 3445it [00:04, 1214.64it/s]warmup run: 3579it [00:04, 1250.50it/s]warmup run: 3712it [00:04, 1273.75it/s]warmup run: 3840it [00:04, 1263.71it/s]warmup run: 3974it [00:04, 1283.95it/s]warmup run: 4000it [00:04, 808.02it/s] 
warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   4%|▍         | 171/4000 [00:00<00:02, 1706.63it/s]warmup should be done:   4%|▍         | 166/4000 [00:00<00:02, 1657.01it/s]warmup should be done:   4%|▍         | 166/4000 [00:00<00:02, 1655.86it/s]warmup should be done:   4%|▍         | 171/4000 [00:00<00:02, 1706.82it/s]warmup should be done:   9%|▉         | 351/4000 [00:00<00:02, 1757.53it/s]warmup should be done:   9%|▊         | 341/4000 [00:00<00:02, 1708.00it/s]warmup should be done:   8%|▊         | 332/4000 [00:00<00:02, 1654.59it/s]warmup should be done:   9%|▉         | 350/4000 [00:00<00:02, 1750.74it/s]warmup should be done:  13%|█▎        | 513/4000 [00:00<00:02, 1712.48it/s]warmup should be done:  13%|█▎        | 531/4000 [00:00<00:01, 1772.21it/s]warmup should be done:  13%|█▎        | 506/4000 [00:00<00:02, 1689.26it/s]warmup should be done:  13%|█▎        | 526/4000 [00:00<00:01, 1738.19it/s]warmup should be done:  18%|█▊        | 710/4000 [00:00<00:01, 1778.94it/s]warmup should be done:  17%|█▋        | 685/4000 [00:00<00:01, 1711.43it/s]warmup should be done:  17%|█▋        | 677/4000 [00:00<00:01, 1695.59it/s]warmup should be done:  18%|█▊        | 700/4000 [00:00<00:01, 1737.16it/s]warmup should be done:  21%|██▏       | 857/4000 [00:00<00:01, 1711.70it/s]warmup should be done:  21%|██▏       | 850/4000 [00:00<00:01, 1706.38it/s]warmup should be done:  22%|██▏       | 874/4000 [00:00<00:01, 1731.60it/s]warmup should be done:  22%|██▏       | 888/4000 [00:00<00:01, 1709.06it/s]warmup should be done:  26%|██▌       | 1021/4000 [00:00<00:01, 1704.60it/s]warmup should be done:  26%|██▌       | 1049/4000 [00:00<00:01, 1735.83it/s]warmup should be done:  26%|██▌       | 1029/4000 [00:00<00:01, 1691.35it/s]warmup should be done:  26%|██▋       | 1060/4000 [00:00<00:01, 1701.74it/s]warmup should be done:  30%|██▉       | 1195/4000 [00:00<00:01, 1713.37it/s]warmup should be done:  31%|███       | 1225/4000 [00:00<00:01, 1743.11it/s]warmup should be done:  30%|███       | 1203/4000 [00:00<00:01, 1706.16it/s]warmup should be done:  31%|███       | 1238/4000 [00:00<00:01, 1726.09it/s]warmup should be done:  35%|███▌      | 1401/4000 [00:00<00:01, 1747.55it/s]warmup should be done:  34%|███▍      | 1367/4000 [00:00<00:01, 1698.84it/s]warmup should be done:  34%|███▍      | 1380/4000 [00:00<00:01, 1724.99it/s]warmup should be done:  35%|███▌      | 1417/4000 [00:00<00:01, 1745.63it/s]warmup should be done:  39%|███▉      | 1578/4000 [00:00<00:01, 1752.62it/s]warmup should be done:  39%|███▊      | 1541/4000 [00:00<00:01, 1710.03it/s]warmup should be done:  39%|███▉      | 1560/4000 [00:00<00:01, 1746.10it/s]warmup should be done:  40%|███▉      | 1596/4000 [00:00<00:01, 1759.28it/s]warmup should be done:  44%|████▍     | 1754/4000 [00:01<00:01, 1754.78it/s]warmup should be done:  43%|████▎     | 1715/4000 [00:01<00:01, 1716.61it/s]warmup should be done:  43%|████▎     | 1735/4000 [00:01<00:01, 1720.45it/s]warmup should be done:  44%|████▍     | 1773/4000 [00:01<00:01, 1744.29it/s]warmup should be done:  48%|████▊     | 1932/4000 [00:01<00:01, 1760.92it/s]warmup should be done:  47%|████▋     | 1889/4000 [00:01<00:01, 1721.49it/s]warmup should be done:  48%|████▊     | 1909/4000 [00:01<00:01, 1726.20it/s]warmup should be done:  49%|████▉     | 1952/4000 [00:01<00:01, 1756.02it/s]warmup should be done:  53%|█████▎    | 2109/4000 [00:01<00:01, 1762.53it/s]warmup should be done:  52%|█████▏    | 2063/4000 [00:01<00:01, 1727.02it/s]warmup should be done:  52%|█████▏    | 2082/4000 [00:01<00:01, 1724.11it/s]warmup should be done:  53%|█████▎    | 2132/4000 [00:01<00:01, 1766.60it/s]warmup should be done:  56%|█████▌    | 2238/4000 [00:01<00:01, 1733.92it/s]warmup should be done:  57%|█████▋    | 2286/4000 [00:01<00:00, 1756.16it/s]warmup should be done:  56%|█████▋    | 2255/4000 [00:01<00:01, 1718.16it/s]warmup should be done:  58%|█████▊    | 2309/4000 [00:01<00:00, 1766.07it/s]warmup should be done:  60%|██████    | 2413/4000 [00:01<00:00, 1738.45it/s]warmup should be done:  62%|██████▏   | 2463/4000 [00:01<00:00, 1758.87it/s]warmup should be done:  61%|██████    | 2428/4000 [00:01<00:00, 1719.14it/s]warmup should be done:  62%|██████▏   | 2489/4000 [00:01<00:00, 1773.68it/s]warmup should be done:  65%|██████▍   | 2590/4000 [00:01<00:00, 1747.73it/s]warmup should be done:  66%|██████▌   | 2641/4000 [00:01<00:00, 1763.76it/s]warmup should be done:  65%|██████▌   | 2606/4000 [00:01<00:00, 1736.84it/s]warmup should be done:  67%|██████▋   | 2669/4000 [00:01<00:00, 1779.16it/s]warmup should be done:  69%|██████▉   | 2765/4000 [00:01<00:00, 1745.96it/s]warmup should be done:  70%|███████   | 2818/4000 [00:01<00:00, 1761.11it/s]warmup should be done:  70%|██████▉   | 2780/4000 [00:01<00:00, 1731.02it/s]warmup should be done:  71%|███████   | 2848/4000 [00:01<00:00, 1782.00it/s]warmup should be done:  75%|███████▍  | 2995/4000 [00:01<00:00, 1758.68it/s]warmup should be done:  74%|███████▎  | 2940/4000 [00:01<00:00, 1732.75it/s]warmup should be done:  74%|███████▍  | 2956/4000 [00:01<00:00, 1738.86it/s]warmup should be done:  76%|███████▌  | 3028/4000 [00:01<00:00, 1787.01it/s]warmup should be done:  79%|███████▉  | 3172/4000 [00:01<00:00, 1759.27it/s]warmup should be done:  78%|███████▊  | 3116/4000 [00:01<00:00, 1740.48it/s]warmup should be done:  78%|███████▊  | 3133/4000 [00:01<00:00, 1746.58it/s]warmup should be done:  80%|████████  | 3207/4000 [00:01<00:00, 1781.92it/s]warmup should be done:  84%|████████▍ | 3350/4000 [00:01<00:00, 1762.90it/s]warmup should be done:  82%|████████▏ | 3291/4000 [00:01<00:00, 1736.07it/s]warmup should be done:  83%|████████▎ | 3308/4000 [00:01<00:00, 1735.00it/s]warmup should be done:  85%|████████▍ | 3386/4000 [00:01<00:00, 1772.76it/s]warmup should be done:  88%|████████▊ | 3527/4000 [00:02<00:00, 1761.67it/s]warmup should be done:  87%|████████▋ | 3467/4000 [00:02<00:00, 1741.30it/s]warmup should be done:  87%|████████▋ | 3485/4000 [00:02<00:00, 1744.45it/s]warmup should be done:  89%|████████▉ | 3564/4000 [00:02<00:00, 1757.14it/s]warmup should be done:  93%|█████████▎| 3706/4000 [00:02<00:00, 1769.08it/s]warmup should be done:  91%|█████████ | 3642/4000 [00:02<00:00, 1735.07it/s]warmup should be done:  92%|█████████▏| 3660/4000 [00:02<00:00, 1731.78it/s]warmup should be done:  94%|█████████▎| 3740/4000 [00:02<00:00, 1746.54it/s]warmup should be done:  97%|█████████▋| 3885/4000 [00:02<00:00, 1774.14it/s]warmup should be done:  95%|█████████▌| 3817/4000 [00:02<00:00, 1737.78it/s]warmup should be done:  96%|█████████▌| 3835/4000 [00:02<00:00, 1736.39it/s]warmup should be done:  98%|█████████▊| 3915/4000 [00:02<00:00, 1733.73it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1756.47it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1753.46it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1725.91it/s]warmup should be done: 100%|█████████▉| 3991/4000 [00:02<00:00, 1682.14it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1716.09it/s]
warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]

warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   4%|▍         | 166/4000 [00:00<00:02, 1658.26it/s]warmup should be done:   4%|▍         | 175/4000 [00:00<00:02, 1744.51it/s]warmup should be done:   4%|▍         | 166/4000 [00:00<00:02, 1653.88it/s]warmup should be done:   4%|▍         | 160/4000 [00:00<00:02, 1596.03it/s]warmup should be done:   9%|▊         | 349/4000 [00:00<00:02, 1758.89it/s]warmup should be done:   9%|▉         | 350/4000 [00:00<00:02, 1762.32it/s]warmup should be done:   9%|▉         | 350/4000 [00:00<00:02, 1744.26it/s]warmup should be done:   9%|▊         | 341/4000 [00:00<00:02, 1717.47it/s]warmup should be done:  13%|█▎        | 534/4000 [00:00<00:01, 1800.00it/s]warmup should be done:  13%|█▎        | 533/4000 [00:00<00:01, 1788.64it/s]warmup should be done:  13%|█▎        | 523/4000 [00:00<00:01, 1760.65it/s]warmup should be done:  13%|█▎        | 525/4000 [00:00<00:02, 1715.61it/s]warmup should be done:  18%|█▊        | 717/4000 [00:00<00:01, 1809.42it/s]warmup should be done:  18%|█▊        | 718/4000 [00:00<00:01, 1810.51it/s]warmup should be done:  18%|█▊        | 705/4000 [00:00<00:01, 1781.54it/s]warmup should be done:  18%|█▊        | 706/4000 [00:00<00:01, 1751.52it/s]warmup should be done:  22%|██▎       | 900/4000 [00:00<00:01, 1813.76it/s]warmup should be done:  23%|██▎       | 903/4000 [00:00<00:01, 1821.40it/s]warmup should be done:  22%|██▏       | 886/4000 [00:00<00:01, 1790.94it/s]warmup should be done:  22%|██▏       | 888/4000 [00:00<00:01, 1773.04it/s]warmup should be done:  27%|██▋       | 1082/4000 [00:00<00:01, 1814.21it/s]warmup should be done:  27%|██▋       | 1068/4000 [00:00<00:01, 1800.00it/s]warmup should be done:  27%|██▋       | 1087/4000 [00:00<00:01, 1825.40it/s]warmup should be done:  27%|██▋       | 1070/4000 [00:00<00:01, 1787.20it/s]warmup should be done:  32%|███▏      | 1266/4000 [00:00<00:01, 1821.58it/s]warmup should be done:  31%|███▏      | 1251/4000 [00:00<00:01, 1808.45it/s]warmup should be done:  32%|███▏      | 1271/4000 [00:00<00:01, 1828.53it/s]warmup should be done:  31%|███▏      | 1253/4000 [00:00<00:01, 1798.28it/s]warmup should be done:  36%|███▌      | 1434/4000 [00:00<00:01, 1812.85it/s]warmup should be done:  36%|███▋      | 1455/4000 [00:00<00:01, 1830.91it/s]warmup should be done:  36%|███▌      | 1449/4000 [00:00<00:01, 1801.99it/s]warmup should be done:  36%|███▌      | 1435/4000 [00:00<00:01, 1804.00it/s]warmup should be done:  40%|████      | 1617/4000 [00:00<00:01, 1816.70it/s]warmup should be done:  41%|████      | 1639/4000 [00:00<00:01, 1832.16it/s]warmup should be done:  40%|████      | 1618/4000 [00:00<00:01, 1809.38it/s]warmup should be done:  41%|████      | 1630/4000 [00:00<00:01, 1788.48it/s]warmup should be done:  45%|████▌     | 1800/4000 [00:01<00:01, 1819.37it/s]warmup should be done:  46%|████▌     | 1823/4000 [00:01<00:01, 1830.96it/s]warmup should be done:  45%|████▌     | 1800/4000 [00:01<00:01, 1812.26it/s]warmup should be done:  45%|████▌     | 1809/4000 [00:01<00:01, 1787.60it/s]warmup should be done:  50%|████▉     | 1983/4000 [00:01<00:01, 1819.91it/s]warmup should be done:  50%|████▉     | 1982/4000 [00:01<00:01, 1811.42it/s]warmup should be done:  50%|█████     | 2007/4000 [00:01<00:01, 1782.74it/s]warmup should be done:  50%|████▉     | 1988/4000 [00:01<00:01, 1740.04it/s]warmup should be done:  54%|█████▍    | 2166/4000 [00:01<00:01, 1820.15it/s]warmup should be done:  54%|█████▍    | 2164/4000 [00:01<00:01, 1813.19it/s]warmup should be done:  54%|█████▍    | 2173/4000 [00:01<00:01, 1772.17it/s]warmup should be done:  55%|█████▍    | 2186/4000 [00:01<00:01, 1751.51it/s]warmup should be done:  59%|█████▊    | 2346/4000 [00:01<00:00, 1813.62it/s]warmup should be done:  59%|█████▊    | 2349/4000 [00:01<00:00, 1784.52it/s]warmup should be done:  59%|█████▉    | 2351/4000 [00:01<00:00, 1760.14it/s]warmup should be done:  59%|█████▉    | 2362/4000 [00:01<00:00, 1718.90it/s]warmup should be done:  63%|██████▎   | 2529/4000 [00:01<00:00, 1816.58it/s]warmup should be done:  63%|██████▎   | 2528/4000 [00:01<00:00, 1772.58it/s]warmup should be done:  63%|██████▎   | 2528/4000 [00:01<00:00, 1760.57it/s]warmup should be done:  63%|██████▎   | 2535/4000 [00:01<00:00, 1704.83it/s]warmup should be done:  68%|██████▊   | 2711/4000 [00:01<00:00, 1813.29it/s]warmup should be done:  68%|██████▊   | 2706/4000 [00:01<00:00, 1762.06it/s]warmup should be done:  68%|██████▊   | 2708/4000 [00:01<00:00, 1771.68it/s]warmup should be done:  68%|██████▊   | 2706/4000 [00:01<00:00, 1693.91it/s]warmup should be done:  72%|███████▏  | 2893/4000 [00:01<00:00, 1815.05it/s]warmup should be done:  72%|███████▏  | 2883/4000 [00:01<00:00, 1754.00it/s]warmup should be done:  72%|███████▏  | 2886/4000 [00:01<00:00, 1773.95it/s]warmup should be done:  72%|███████▏  | 2876/4000 [00:01<00:00, 1686.49it/s]warmup should be done:  77%|███████▋  | 3075/4000 [00:01<00:00, 1810.89it/s]warmup should be done:  76%|███████▋  | 3059/4000 [00:01<00:00, 1749.24it/s]warmup should be done:  77%|███████▋  | 3070/4000 [00:01<00:00, 1791.22it/s]warmup should be done:  76%|███████▌  | 3045/4000 [00:01<00:00, 1683.63it/s]warmup should be done:  81%|████████▏ | 3258/4000 [00:01<00:00, 1814.17it/s]warmup should be done:  81%|████████▏ | 3254/4000 [00:01<00:00, 1805.67it/s]warmup should be done:  81%|████████  | 3234/4000 [00:01<00:00, 1738.42it/s]warmup should be done:  80%|████████  | 3214/4000 [00:01<00:00, 1683.55it/s]warmup should be done:  86%|████████▌ | 3440/4000 [00:01<00:00, 1811.46it/s]warmup should be done:  85%|████████▌ | 3408/4000 [00:01<00:00, 1736.01it/s]warmup should be done:  86%|████████▌ | 3435/4000 [00:01<00:00, 1799.72it/s]warmup should be done:  85%|████████▍ | 3383/4000 [00:01<00:00, 1683.17it/s]warmup should be done:  91%|█████████ | 3622/4000 [00:02<00:00, 1808.28it/s]warmup should be done:  90%|████████▉ | 3588/4000 [00:02<00:00, 1753.34it/s]warmup should be done:  90%|█████████ | 3617/4000 [00:02<00:00, 1802.84it/s]warmup should be done:  89%|████████▉ | 3552/4000 [00:02<00:00, 1684.90it/s]warmup should be done:  95%|█████████▌| 3803/4000 [00:02<00:00, 1801.33it/s]warmup should be done:  94%|█████████▍| 3769/4000 [00:02<00:00, 1770.12it/s]warmup should be done:  95%|█████████▍| 3798/4000 [00:02<00:00, 1804.32it/s]warmup should be done:  93%|█████████▎| 3721/4000 [00:02<00:00, 1686.27it/s]warmup should be done: 100%|█████████▉| 3985/4000 [00:02<00:00, 1804.25it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1799.59it/s]warmup should be done:  99%|█████████▊| 3949/4000 [00:02<00:00, 1778.15it/s]warmup should be done: 100%|█████████▉| 3982/4000 [00:02<00:00, 1813.62it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1789.74it/s]warmup should be done:  97%|█████████▋| 3891/4000 [00:02<00:00, 1689.51it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1777.26it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1738.29it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f070434ca00>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f07042fd9a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f07042fdf10>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7f070a6b87c0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[HCTR][17:11:05.272][ERROR][RK0][tid #139654342895360]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][17:11:05.279][ERROR][RK0][tid #139654342895360]: coll ps creation done
[HCTR][17:11:05.338][ERROR][RK0][tid #139654326109952]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][17:11:05.343][ERROR][RK0][tid #139654326109952]: coll ps creation done
[HCTR][17:11:05.407][ERROR][RK0][tid #139654351288064]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][17:11:05.412][ERROR][RK0][tid #139654351288064]: coll ps creation done
[HCTR][17:11:05.481][ERROR][RK0][tid #139654284179200]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][17:11:05.487][ERROR][RK0][tid #139654284179200]: coll ps creation done
[HCTR][17:11:05.487][ERROR][RK0][tid #139654342895360]: replica 0 preparing frequency
[2023-04-14 17:11:05.488043: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5147173 into 0
[2023-04-14 17:11:05.513164: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 164849087
[2023-04-14 17:11:05.514357: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5147941 into 5147173
[2023-04-14 17:11:05.539321: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 110759886
[2023-04-14 17:11:05.540475: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5147555 into 10295114
[2023-04-14 17:11:05.566285: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 89874188
[2023-04-14 17:11:05.567457: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5147156 into 15442669
[2023-04-14 17:11:05.593318: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 78713319
[2023-04-14 17:11:05.594493: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5144466 into 20589825
[2023-04-14 17:11:05.619487: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 71625330
[2023-04-14 17:11:05.620656: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5145829 into 25734291
[2023-04-14 17:11:05.645579: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 66663476
[2023-04-14 17:11:05.646738: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5143614 into 30880120
[2023-04-14 17:11:05.671696: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 62992780
[2023-04-14 17:11:05.672863: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5148450 into 36023734
[2023-04-14 17:11:05.697873: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 60106019
[2023-04-14 17:11:05.699042: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5142757 into 41172184
[2023-04-14 17:11:05.724010: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 57780940
[2023-04-14 17:11:05.725175: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5143413 into 46314941
[2023-04-14 17:11:05.750076: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 55834975
[HCTR][17:11:05.751][ERROR][RK0][tid #139654326109952]: replica 1 preparing frequency
[2023-04-14 17:11:05.751314: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5143780 into 51458354
[2023-04-14 17:11:05.776607: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 164853363
[2023-04-14 17:11:05.777781: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5146765 into 56602134
[2023-04-14 17:11:05.803137: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 110746547
[2023-04-14 17:11:05.804341: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5146154 into 61748899
[2023-04-14 17:11:05.834474: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 89906396
[2023-04-14 17:11:05.835639: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5146917 into 66895053
[2023-04-14 17:11:05.860920: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 78698815
[2023-04-14 17:11:05.862095: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5145063 into 72041970
[2023-04-14 17:11:05.902649: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 71618429
[2023-04-14 17:11:05.903846: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5145118 into 77187033
[2023-04-14 17:11:05.929090: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 66668395
[2023-04-14 17:11:05.930268: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5144071 into 82332151
[2023-04-14 17:11:05.955522: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 62975848
[2023-04-14 17:11:05.956707: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5144282 into 87476222
[2023-04-14 17:11:05.982896: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 60112283
[2023-04-14 17:11:05.984066: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5144238 into 92620504
[2023-04-14 17:11:06.  9203: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 57780516
[2023-04-14 17:11:06. 10364: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5146631 into 97764742
[2023-04-14 17:11:06. 35776: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 55839408
[HCTR][17:11:06.036][ERROR][RK0][tid #139654284179200]: replica 2 preparing frequency
[2023-04-14 17:11:06. 37006: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5154132 into 102911373
[2023-04-14 17:11:06. 62370: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 164845958
[2023-04-14 17:11:06. 64053: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5145479 into 108065505
[2023-04-14 17:11:06. 89222: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 110740155
[2023-04-14 17:11:06. 91138: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5144971 into 113210984
[2023-04-14 17:11:06.116323: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 89902619
[2023-04-14 17:11:06.118234: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5143497 into 118355955
[2023-04-14 17:11:06.143542: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 78687063
[2023-04-14 17:11:06.145464: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5144989 into 123499452
[2023-04-14 17:11:06.170657: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 71609541
[2023-04-14 17:11:06.172581: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5146346 into 128644441
[2023-04-14 17:11:06.197765: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 66675458
[2023-04-14 17:11:06.199706: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5150794 into 133790787
[2023-04-14 17:11:06.224955: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 62993180
[2023-04-14 17:11:06.226959: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5145891 into 138941581
[2023-04-14 17:11:06.252593: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 60103543
[2023-04-14 17:11:06.254552: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5144904 into 144087472
[2023-04-14 17:11:06.279715: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 57788840
[2023-04-14 17:11:06.281622: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5145897 into 149232376
[2023-04-14 17:11:06.306843: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 55853643
[HCTR][17:11:06.308][ERROR][RK0][tid #139654351288064]: replica 3 preparing frequency
[2023-04-14 17:11:06.308837: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5145885 into 154378273
[2023-04-14 17:11:06.334294: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 164840721
[2023-04-14 17:11:06.335543: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5150673 into 159524158
[2023-04-14 17:11:06.360671: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 110747220
[2023-04-14 17:11:06.361853: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5140907 into 164674831
[2023-04-14 17:11:06.386894: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 89880428
[2023-04-14 17:11:06.388059: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5145650 into 169815738
[2023-04-14 17:11:06.413245: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 78702322
[2023-04-14 17:11:06.414407: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5146555 into 174961388
[2023-04-14 17:11:06.439756: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 71615162
[2023-04-14 17:11:06.440930: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5145211 into 180107943
[2023-04-14 17:11:06.466894: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 66689687
[2023-04-14 17:11:06.468056: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5144744 into 185253154
[2023-04-14 17:11:06.494002: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 62982078
[2023-04-14 17:11:06.495182: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5148050 into 190397898
[2023-04-14 17:11:06.520284: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 60111145
[2023-04-14 17:11:06.521439: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5147657 into 195545948
[2023-04-14 17:11:06.546531: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 57781271
[2023-04-14 17:11:06.547701: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 5149041 into 200693605
[2023-04-14 17:11:06.572770: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 55849966
[2023-04-14 17:11:06.573943: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:266] freq recorder global combining
[2023-04-14 17:11:22.224527: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:269] freq recorder global combine from 205842646 to 134303819
[2023-04-14 17:11:23.653827: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:286] top 5 freq is 4431505,4430889,4430653,4430306,4429784
[HCTR][17:11:23.693][ERROR][RK0][tid #139654326109952]: Calling build_v2
[HCTR][17:11:23.693][ERROR][RK0][tid #139654326109952]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2023-04-14 17:11:23.693325: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:141] using concurrent impl MPSPhase
[2023-04-14 17:11:23.693385: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:409] before scale, dtype is 0, dim is 128
[2023-04-14 17:11:23.693415: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:415] after scale, dtype is 7, new dim is 32
[2023-04-14 17:11:23[HCTR][17:11:23.693][ERROR][RK0][tid #139654342895360]: Calling build_v2
.693712: E[HCTR][17:11:23.693][ERROR][RK0][tid #139654342895360]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
 /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:207] assigning 8 to cpu
[[2023-04-14 17:11:232023-04-14 17:11:23..693780693787: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::141224] ] using concurrent impl MPSPhasebuild symm link desc with 4X Tesla V100-SXM2-16GB out of 4

[2023-04-14 17:11:23.[6938522023-04-14 17:11:23: .E693858 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE: 409/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] :before scale, dtype is 0, dim is 128225
] remote time is 9.21053
[2023-04-14 17:11:23.[6939032023-04-14 17:11:23: .E693909 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE: 415/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[HCTR][17:11:23.693][ERROR][RK0][tid #139654351288064]: Calling build_v2
] :after scale, dtype is 7, new dim is 32226
] cpu time is 31.8182
[HCTR][17:11:23.693][ERROR][RK0][tid #139654351288064]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2023-04-14 17:11:23.693990: [HCTR][17:11:23.693][ERROR][RK0][tid #139654284179200]: Calling build_v2
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:425] registering cpu data with 16.00 GB
[HCTR][17:11:23.694][ERROR][RK0][tid #139654284179200]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2023-04-14 17:11:23.694077: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:141] using concurrent impl MPSPhase
[2023-04-14 17:11:23.694114: [E2023-04-14 17:11:23 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc694139:: 141E]  using concurrent impl MPSPhase/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc
:409] before scale, dtype is 0, dim is 128
[2023-04-14 17:11:23.[6941812023-04-14 17:11:23: .E694187 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccE: 409/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] :before scale, dtype is 0, dim is 128415
] after scale, dtype is 7, new dim is 32
[2023-04-14 17:11:23.694232: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:415] [after scale, dtype is 7, new dim is 322023-04-14 17:11:23
.694250: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:207] assigning 8 to cpu
[2023-04-14 17:11:23.694323: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:224] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2023-04-14 17:11:23.694363: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:225] remote time is 9.21053
[2023-04-14 17:11:23.694395: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:226] cpu time is 31.8182
[2023-04-14 17:11:23.694435: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:425] registering cpu data with 16.00 GB
[[2023-04-14 17:11:232023-04-14 17:11:23..694899694915: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::207207] ] assigning 8 to cpuassigning 8 to cpu

[2023-04-14 17:11:23.695025: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:224] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2023-04-14 17:11:23.695096: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:225] remote time is 9.21053
[2023-04-14 17:11:23.695139: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2023-04-14 17:11:23226.] 695154cpu time is 31.8182: 
E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:224] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[[2023-04-14 17:11:232023-04-14 17:11:23..695204695209: : EE  /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc::425225] ] registering cpu data with 16.00 GBremote time is 9.21053

[2023-04-14 17:11:23.695272: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:226] cpu time is 31.8182
[2023-04-14 17:11:23.695310: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:425] registering cpu data with 16.00 GB
[2023-04-14 17:11:31.997583: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-14 17:11:32. 18370: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-14 17:11:32. 33486: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-14 17:11:32. 39255: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-14 17:11:32. 39375: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:174] creating solver
[2023-04-14 17:11:32. 39423: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:214] solver created. now build & solve
[2023-04-14 17:11:32.396808: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 2.98 GB
[2023-04-14 17:11:32.396928: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:309] reconfigured max freq to be 4.4315e+06
[2023-04-14 17:11:32.396960: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:311] reconfigured num slot to be 84
[2023-04-14 17:11:32.396989: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:318] counting slots...
[2023-04-14 17:11:37.336482: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:367] Final num slot is 95
[2023-04-14 17:11:37.336619: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:371] preparing block granularity...
[2023-04-14 17:11:37.336657: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 0 has 100 nodes, max_size set to 25, #slice=4
[2023-04-14 17:11:37.336691: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 3 has 100 nodes, max_size set to 25, #slice=4
[2023-04-14 17:11:37.336719: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 5 has 100 nodes, max_size set to 25, #slice=4
[2023-04-14 17:11:37.336748: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 7 has 100 nodes, max_size set to 25, #slice=4
[2023-04-14 17:11:37.336777: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 8 has 100 nodes, max_size set to 25, #slice=4
[2023-04-14 17:11:37.336806: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 9 has 100 nodes, max_size set to 25, #slice=4
[2023-04-14 17:11:37.336835: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 10 has 100 nodes, max_size set to 25, #slice=4
[2023-04-14 17:11:37.336864: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 11 has 100 nodes, max_size set to 25, #slice=4
[2023-04-14 17:11:37.336904: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 12 has 100 nodes, max_size set to 25, #slice=4
[2023-04-14 17:11:37.336932: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 13 has 200 nodes, max_size set to 50, #slice=4
[2023-04-14 17:11:37.336961: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 14 has 200 nodes, max_size set to 50, #slice=4
[2023-04-14 17:11:37.336990: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 15 has 200 nodes, max_size set to 50, #slice=4
[2023-04-14 17:11:37.337018: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 16 has 300 nodes, max_size set to 75, #slice=4
[2023-04-14 17:11:37.337046: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 17 has 300 nodes, max_size set to 75, #slice=4
[2023-04-14 17:11:37.337075: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 18 has 400 nodes, max_size set to 100, #slice=4
[2023-04-14 17:11:37.337103: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 19 has 400 nodes, max_size set to 100, #slice=4
[2023-04-14 17:11:37.337132: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 20 has 500 nodes, max_size set to 125, #slice=4
[2023-04-14 17:11:37.337161: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 21 has 581 nodes, max_size set to 146, #slice=4
[2023-04-14 17:11:37.337190: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 22 has 624 nodes, max_size set to 156, #slice=4
[2023-04-14 17:11:37.337219: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 23 has 797 nodes, max_size set to 200, #slice=4
[2023-04-14 17:11:37.337248: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 24 has 901 nodes, max_size set to 226, #slice=4
[2023-04-14 17:11:37.337277: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 25 has 1053 nodes, max_size set to 264, #slice=4
[2023-04-14 17:11:37.337305: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 26 has 1228 nodes, max_size set to 307, #slice=4
[2023-04-14 17:11:37.337333: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 27 has 1425 nodes, max_size set to 357, #slice=4
[2023-04-14 17:11:37.337362: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 28 has 1651 nodes, max_size set to 413, #slice=4
[2023-04-14 17:11:37.337391: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 29 has 1928 nodes, max_size set to 482, #slice=4
[2023-04-14 17:11:37.337419: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 30 has 2245 nodes, max_size set to 562, #slice=4
[2023-04-14 17:11:37.337448: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 31 has 2627 nodes, max_size set to 657, #slice=4
[2023-04-14 17:11:37.337476: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 32 has 3034 nodes, max_size set to 759, #slice=4
[2023-04-14 17:11:37.337505: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 33 has 3550 nodes, max_size set to 888, #slice=4
[2023-04-14 17:11:37.337535: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 34 has 4131 nodes, max_size set to 1033, #slice=4
[2023-04-14 17:11:37.337567: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 35 has 4816 nodes, max_size set to 1204, #slice=4
[2023-04-14 17:11:37.337596: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 36 has 5556 nodes, max_size set to 1389, #slice=4
[2023-04-14 17:11:37.337625: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 37 has 6526 nodes, max_size set to 1632, #slice=4
[2023-04-14 17:11:37.337653: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 38 has 7567 nodes, max_size set to 1892, #slice=4
[2023-04-14 17:11:37.337682: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 39 has 8825 nodes, max_size set to 2207, #slice=4
[2023-04-14 17:11:37.337712: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 40 has 10234 nodes, max_size set to 2559, #slice=4
[2023-04-14 17:11:37.337741: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 41 has 11988 nodes, max_size set to 2997, #slice=4
[2023-04-14 17:11:37.337770: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 42 has 13982 nodes, max_size set to 3496, #slice=4
[2023-04-14 17:11:37.337799: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 43 has 16086 nodes, max_size set to 4022, #slice=4
[2023-04-14 17:11:37.337827: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 44 has 18910 nodes, max_size set to 4728, #slice=4
[2023-04-14 17:11:37.337855: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 45 has 22002 nodes, max_size set to 5501, #slice=4
[2023-04-14 17:11:37.337885: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 46 has 25511 nodes, max_size set to 6378, #slice=4
[2023-04-14 17:11:37.337913: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 47 has 29756 nodes, max_size set to 7439, #slice=4
[2023-04-14 17:11:37.337942: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 48 has 34671 nodes, max_size set to 8668, #slice=4
[2023-04-14 17:11:37.337970: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 49 has 40584 nodes, max_size set to 10146, #slice=4
[2023-04-14 17:11:37.338000: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 50 has 47049 nodes, max_size set to 11763, #slice=4
[2023-04-14 17:11:37.338029: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 51 has 54080 nodes, max_size set to 13520, #slice=4
[2023-04-14 17:11:37.338058: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 52 has 64629 nodes, max_size set to 16158, #slice=4
[2023-04-14 17:11:37.338086: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 53 has 74569 nodes, max_size set to 18643, #slice=4
[2023-04-14 17:11:37.338115: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 54 has 86152 nodes, max_size set to 21538, #slice=4
[2023-04-14 17:11:37.338143: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 55 has 98875 nodes, max_size set to 24719, #slice=4
[2023-04-14 17:11:37.338172: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 56 has 120700 nodes, max_size set to 30175, #slice=4
[2023-04-14 17:11:37.338200: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 57 has 132900 nodes, max_size set to 33225, #slice=4
[2023-04-14 17:11:37.338232: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 58 has 159756 nodes, max_size set to 39939, #slice=4
[2023-04-14 17:11:37.338261: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 59 has 188977 nodes, max_size set to 47245, #slice=4
[2023-04-14 17:11:37.338291: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 60 has 216281 nodes, max_size set to 54071, #slice=4
[2023-04-14 17:11:37.338319: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 61 has 254523 nodes, max_size set to 63631, #slice=4
[2023-04-14 17:11:37.338348: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 62 has 291998 nodes, max_size set to 73000, #slice=4
[2023-04-14 17:11:37.338377: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 63 has 368410 nodes, max_size set to 92103, #slice=4
[2023-04-14 17:11:37.338406: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 64 has 386722 nodes, max_size set to 96681, #slice=4
[2023-04-14 17:11:37.338434: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 65 has 445255 nodes, max_size set to 111314, #slice=4
[2023-04-14 17:11:37.338463: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 66 has 635308 nodes, max_size set to 158827, #slice=4
[2023-04-14 17:11:37.338492: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 67 has 534808 nodes, max_size set to 133702, #slice=4
[2023-04-14 17:11:37.338531: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 68 has 725691 nodes, max_size set to 181423, #slice=4
[2023-04-14 17:11:37.338558: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 69 has 1049804 nodes, max_size set to 262451, #slice=4
[2023-04-14 17:11:37.338585: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 70 has 1013467 nodes, max_size set to 253367, #slice=4
[2023-04-14 17:11:37.338612: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 71 has 1460823 nodes, max_size set to 365206, #slice=4
[2023-04-14 17:11:37.338639: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 72 has 1013075 nodes, max_size set to 253269, #slice=4
[2023-04-14 17:11:37.338667: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 73 has 1312804 nodes, max_size set to 328201, #slice=4
[2023-04-14 17:11:37.338695: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 74 has 1776619 nodes, max_size set to 444155, #slice=4
[2023-04-14 17:11:37.338724: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 75 has 2558212 nodes, max_size set to 639553, #slice=4
[2023-04-14 17:11:37.338753: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 76 has 4038629 nodes, max_size set to 800000, #slice=8
[2023-04-14 17:11:37.338782: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 77 has 7460126 nodes, max_size set to 800000, #slice=12
[2023-04-14 17:11:37.338810: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 80 has 18827250 nodes, max_size set to 800000, #slice=24
[2023-04-14 17:11:37.338839: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 82 has 88620138 nodes, max_size set to 800000, #slice=112
[2023-04-14 17:11:37.338871: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 83 has 6656265 nodes, max_size set to 6656265, #slice=1
[2023-04-14 17:11:37.338900: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 84 has 6655779 nodes, max_size set to 6655779, #slice=1
[2023-04-14 17:11:37.338929: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 85 has 6660639 nodes, max_size set to 6660639, #slice=1
[2023-04-14 17:11:37.338958: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 86 has 6655047 nodes, max_size set to 6655047, #slice=1
[2023-04-14 17:11:37.338986: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 87 has 6656424 nodes, max_size set to 6656424, #slice=1
[2023-04-14 17:11:37.339016: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 88 has 6658516 nodes, max_size set to 6658516, #slice=1
[2023-04-14 17:11:37.339045: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 89 has 6659546 nodes, max_size set to 6659546, #slice=1
[2023-04-14 17:11:37.339074: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 90 has 6652247 nodes, max_size set to 6652247, #slice=1
[2023-04-14 17:11:37.339104: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 91 has 6657232 nodes, max_size set to 6657232, #slice=1
[2023-04-14 17:11:37.339133: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 92 has 6658714 nodes, max_size set to 6658714, #slice=1
[2023-04-14 17:11:37.339161: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 93 has 66575997 nodes, max_size set to 66575997, #slice=1
[2023-04-14 17:11:37.339191: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 94 has 66562799 nodes, max_size set to 66562799, #slice=1
[2023-04-14 17:11:37.339220: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 95 has 66566208 nodes, max_size set to 66566208, #slice=1
[2023-04-14 17:11:37.339249: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 96 has 66564938 nodes, max_size set to 66564938, #slice=1
[2023-04-14 17:11:37.339278: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 97 has 66567337 nodes, max_size set to 66567337, #slice=1
[2023-04-14 17:11:37.339307: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 98 has 66569545 nodes, max_size set to 66569545, #slice=1
[2023-04-14 17:11:37.339336: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 99 has 66587518 nodes, max_size set to 66587518, #slice=1
[2023-04-14 17:11:37.339366: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 100 has 66571635 nodes, max_size set to 66571635, #slice=1
[2023-04-14 17:11:37.339395: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 101 has 66559795 nodes, max_size set to 66559795, #slice=1
[2023-04-14 17:11:37.339424: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:405] counting blocks...
[2023-04-14 17:11:38.591381: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:425] Final num block is 463
[2023-04-14 17:11:38.591484: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:430] counting freq and density...
[2023-04-14 17:11:38.722441: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:479] averaging freq and density...
[2023-04-14 17:11:38.722552: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:480] 463
[2023-04-14 17:11:38.772894: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:218] solver built. now solve
[2023-04-14 17:11:38.772991: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:893] constructing optimal solver, device=4, stream=1
463 blocks, 4 devices
[2023-04-14 17:11:39.943918: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1078] Add Var...
[2023-04-14 17:11:39.952219: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1096] Capacity...
[2023-04-14 17:11:39.952747: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1099] Connect CPU...
[2023-04-14 17:11:39.959793: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1101] Connect Access To Storage...
[2023-04-14 17:11:40. 15920: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1105] Time...
[2023-04-14 17:11:40. 16741: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1067] dst 0, total sm is 80
[2023-04-14 17:11:40. 17783: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1067] dst 1, total sm is 80
[2023-04-14 17:11:40. 18825: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1067] dst 2, total sm is 80
[2023-04-14 17:11:40. 19853: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1067] dst 3, total sm is 80
[2023-04-14 17:11:40.478691: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1124] Coll Cache init block placement array
[2023-04-14 17:11:40.480509: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1200] Coll Cache init block placement array done
[2023-04-14 17:11:40.480624: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1202] Coll Cache model reset done
[2023-04-14 17:11:40.486682: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:222] solver solved
[2023-04-14 17:11:40.486744: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:437] 0 solved master
[2023-04-14 17:11:40.486777: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 0 solved
[2023-04-14 17:11:40.486810: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 0 initing device 0
[2023-04-14 17:11:40.488134: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-14 17:11:40.488650: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cuh:611] per src size local is 17209799
[2023-04-14 17:11:40.638255: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 2 solved
[2023-04-14 17:11:40.638373: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 2 initing device 2
[2023-04-14 17:11:40.679236: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-14 17:11:40.679266: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 3 solved
[2023-04-14 17:11:40.679465: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 3 initing device 3
[2023-04-14 17:11:40.682453: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-14 17:11:40.739385: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 1 solved
[2023-04-14 17:11:40.739618: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 1 initing device 1
[2023-04-14 17:11:40.742565: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-14 17:11:41. 27019: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 737686713
[2023-04-14 17:11:41.252998: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 737686713
[2023-04-14 17:11:41.292311: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 737686713
[2023-04-14 17:11:41.324574: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 737686713
[2023-04-14 17:11:41.712666: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 62313287 possible elem, scale to 134217728
[2023-04-14 17:11:41.712774: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 1024.00 MB
[2023-04-14 17:11:41.920953: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 62313287 possible elem, scale to 134217728
[2023-04-14 17:11:41.921046: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 1024.00 MB
[2023-04-14 17:11:41.988256: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 62313287 possible elem, scale to 134217728
[2023-04-14 17:11:41.988344: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 1024.00 MB
[2023-04-14 17:11:42. 14701: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 62313287 possible elem, scale to 134217728
[2023-04-14 17:11:42. 14775: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 1024.00 MB
[2023-04-14 17:11:42.243878: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?16799999->1154818
[2023-04-14 17:11:42.247732: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?16799999->1550846
[2023-04-14 17:11:42.248872: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15645181 / 800000000 nodes ( 1.96 %~2.00 %) | remote 46668106 / 800000000 nodes ( 5.83 %) | cpu 737686713 / 800000000 nodes ( 92.21 %) | 8.01 GB | 1.7607 secs 
[2023-04-14 17:11:42.249639: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 14.72 GB
[2023-04-14 17:11:42.250051: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] [before create ctx, mem is 14.72 GB2023-04-14 17:11:42
.250162[: E 2023-04-14 17:11:42/hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:.2439] 250202Asymm Coll cache (policy: coll_cache_asymm_link) | local 15249153 / 800000000 nodes ( 1.91 %~2.00 %) | remote 47064134 / 800000000 nodes ( 5.88 %) | cpu 737686713 / 800000000 nodes ( 92.21 %) | 8.01 GB | 1.56757 secs : 
W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 14.72 GB
[2023-04-14 17:11:42.250084: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 14.72 GB
[2023-04-14 17:11:42.260319: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?16799999->922145
[2023-04-14 17:11:42.262692: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?16799999->1063891
[2023-04-14 17:11:42.262876: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15877854 / 800000000 nodes ( 1.98 %~2.00 %) | remote 46435433 / 800000000 nodes ( 5.80 %) | cpu 737686713 / 800000000 nodes ( 92.21 %) | 8.01 GB | 1.58351 secs 
[2023-04-14 17:11:42.265168: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: coll_cache_asymm_link) | local 15736108 / 800000000 nodes ( 1.97 %~2.00 %) | remote 46577179 / 800000000 nodes ( 5.82 %) | cpu 737686713 / 800000000 nodes ( 92.21 %) | 8.01 GB | 1.5225 secs 
[2023-04-14 17:11:45.759047: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 15.57 GB
[2023-04-14 17:11:45.759246: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 15.57 GB
[2023-04-14 17:11:45.855501: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 15.61 GB
[2023-04-14 17:11:45.855646: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 15.61 GB
[2023-04-14 17:11:45.904066: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 15.62 GB
[2023-04-14 17:11:45.904192: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 15.62 GB
[2023-04-14 17:11:45.984778: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 15.65 GB
[2023-04-14 17:11:45.984890: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 15.65 GB
[HCTR][17:11:46.142][ERROR][RK0][tid #139654351288064]: 3 allocated 3276800 at 0x7eef0c238400
[HCTR][17:11:46.142][ERROR][RK0][tid #139654351288064]: 3 allocated 6553600 at 0x7eef0c558400
[HCTR][17:11:46.142][ERROR][RK0][tid #139654351288064]: 3 allocated 3276800 at 0x7eef0cb98400
[HCTR][17:11:46.142][ERROR][RK0][tid #139654351288064]: 3 allocated 6553600 at 0x7eef0ceb8400
[HCTR][17:11:46.142][ERROR][RK0][tid #139654770693888]: 2 allocated 3276800 at 0x7eee98238400
[HCTR][17:11:46.142][ERROR][RK0][tid #139654770693888]: 2 allocated 6553600 at 0x7eee98558400
[HCTR][17:11:46.142][ERROR][RK0][tid #139654770693888]: 2 allocated 3276800 at 0x7eee98b98400
[HCTR][17:11:46.142][ERROR][RK0][tid #139654770693888]: 2 allocated 6553600 at 0x7eee98eb8400
[HCTR][17:11:46.142][ERROR][RK0][tid #139654342895360]: 1 allocated 3276800 at 0x7eee80238400
[HCTR][17:11:46.143][ERROR][RK0][tid #139654342895360]: 1 allocated 6553600 at 0x7eee80558400
[HCTR][17:11:46.143][ERROR][RK0][tid #139654342895360]: 1 allocated 3276800 at 0x7eee80b98400
[HCTR][17:11:46.143][ERROR][RK0][tid #139654342895360]: 1 allocated 6553600 at 0x7eee80eb8400
[HCTR][17:11:46.143][ERROR][RK0][tid #139654837802752]: 0 allocated 3276800 at 0x7eeef2320000
[HCTR][17:11:46.143][ERROR][RK0][tid #139654837802752]: 0 allocated 6553600 at 0x7eeef2640000
[HCTR][17:11:46.143][ERROR][RK0][tid #139654837802752]: 0 allocated 3276800 at 0x7eeef2c80000
[HCTR][17:11:46.143][ERROR][RK0][tid #139654837802752]: 0 allocated 6553600 at 0x7eeef2fa0000
