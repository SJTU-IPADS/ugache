[HCTR][17:24:32.403][ERROR][RK0][main]: using mock embedding with 882774592 * 128 elements
[HCTR][17:24:32.410][ERROR][RK0][main]: using mock embedding with 882774592 * 128 elements
[HCTR][17:24:32.450][ERROR][RK0][main]: using mock embedding with 882774592 * 128 elements
[HCTR][17:24:32.462][ERROR][RK0][main]: using mock embedding with 882774592 * 128 elements
warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 0it [00:00, ?it/s]warmup run: 1it [00:00,  3.45it/s]warmup run: 1it [00:00,  3.46it/s]warmup run: 1it [00:00,  3.45it/s]warmup run: 1it [00:00,  3.41it/s]warmup run: 82it [00:00, 268.96it/s]warmup run: 85it [00:00, 280.15it/s]warmup run: 83it [00:00, 272.83it/s]warmup run: 79it [00:00, 256.99it/s]warmup run: 158it [00:00, 425.26it/s]warmup run: 149it [00:00, 394.47it/s]warmup run: 150it [00:00, 399.15it/s]warmup run: 148it [00:00, 393.15it/s]warmup run: 231it [00:00, 519.70it/s]warmup run: 226it [00:00, 510.66it/s]warmup run: 220it [00:00, 492.14it/s]warmup run: 217it [00:00, 483.57it/s]warmup run: 297it [00:00, 562.69it/s]warmup run: 292it [00:00, 555.22it/s]warmup run: 293it [00:00, 563.23it/s]warmup run: 285it [00:00, 542.38it/s]warmup run: 369it [00:00, 609.23it/s]warmup run: 359it [00:00, 590.08it/s]warmup run: 372it [00:00, 632.06it/s]warmup run: 357it [00:00, 594.57it/s]warmup run: 441it [00:00, 641.48it/s]warmup run: 430it [00:00, 625.48it/s]warmup run: 450it [00:00, 676.24it/s]warmup run: 425it [00:00, 620.02it/s]warmup run: 511it [00:00, 656.59it/s]warmup run: 501it [00:00, 649.85it/s]warmup run: 523it [00:00, 691.45it/s]warmup run: 495it [00:00, 644.01it/s]warmup run: 583it [00:01, 675.35it/s]warmup run: 570it [00:01, 656.61it/s]warmup run: 596it [00:01, 698.31it/s]warmup run: 567it [00:01, 665.71it/s]warmup run: 638it [00:01, 662.20it/s]warmup run: 653it [00:01, 674.18it/s]warmup run: 638it [00:01, 678.20it/s]warmup run: 669it [00:01, 688.13it/s]warmup run: 709it [00:01, 674.59it/s]warmup run: 725it [00:01, 686.45it/s]warmup run: 710it [00:01, 688.45it/s]warmup run: 745it [00:01, 706.51it/s]warmup run: 799it [00:01, 700.97it/s]warmup run: 780it [00:01, 689.41it/s]warmup run: 778it [00:01, 673.10it/s]warmup run: 817it [00:01, 707.39it/s]warmup run: 872it [00:01, 708.87it/s]warmup run: 856it [00:01, 710.35it/s]warmup run: 847it [00:01, 669.12it/s]warmup run: 889it [00:01, 694.52it/s]warmup run: 945it [00:01, 713.74it/s]warmup run: 928it [00:01, 696.57it/s]warmup run: 915it [00:01, 665.63it/s]warmup run: 960it [00:01, 690.03it/s]warmup run: 1017it [00:01, 710.09it/s]warmup run: 982it [00:01, 663.98it/s]warmup run: 999it [00:01, 694.23it/s]warmup run: 1034it [00:01, 702.84it/s]warmup run: 1089it [00:01, 702.24it/s]warmup run: 1057it [00:01, 688.94it/s]warmup run: 1070it [00:01, 695.58it/s]warmup run: 1113it [00:01, 726.16it/s]warmup run: 1161it [00:01, 705.97it/s]warmup run: 1133it [00:01, 709.15it/s]warmup run: 1142it [00:01, 701.11it/s]warmup run: 1186it [00:01, 716.71it/s]warmup run: 1232it [00:02, 706.39it/s]warmup run: 1208it [00:02, 720.23it/s]warmup run: 1214it [00:02, 703.53it/s]warmup run: 1259it [00:02, 720.43it/s]warmup run: 1304it [00:02, 709.42it/s]warmup run: 1290it [00:02, 748.45it/s]warmup run: 1285it [00:02, 692.79it/s]warmup run: 1333it [00:02, 723.41it/s]warmup run: 1377it [00:02, 713.11it/s]warmup run: 1365it [00:02, 733.06it/s]warmup run: 1358it [00:02, 702.20it/s]warmup run: 1406it [00:02, 708.45it/s]warmup run: 1450it [00:02, 716.99it/s]warmup run: 1439it [00:02, 728.02it/s]warmup run: 1430it [00:02, 706.92it/s]warmup run: 1477it [00:02, 699.11it/s]warmup run: 1527it [00:02, 730.51it/s]warmup run: 1503it [00:02, 713.62it/s]warmup run: 1512it [00:02, 721.77it/s]warmup run: 1548it [00:02, 697.10it/s]warmup run: 1601it [00:02, 723.20it/s]warmup run: 1575it [00:02, 709.00it/s]warmup run: 1585it [00:02, 705.73it/s]warmup run: 1618it [00:02, 685.36it/s]warmup run: 1674it [00:02, 720.79it/s]warmup run: 1646it [00:02, 694.38it/s]warmup run: 1656it [00:02, 706.04it/s]warmup run: 1687it [00:02, 672.96it/s]warmup run: 1747it [00:02, 718.86it/s]warmup run: 1716it [00:02, 689.45it/s]warmup run: 1727it [00:02, 694.08it/s]warmup run: 1756it [00:02, 677.53it/s]warmup run: 1819it [00:02, 717.24it/s]warmup run: 1790it [00:02, 702.39it/s]warmup run: 1799it [00:02, 698.76it/s]warmup run: 1824it [00:02, 672.08it/s]warmup run: 1892it [00:02, 720.47it/s]warmup run: 1873it [00:02, 739.09it/s]warmup run: 1874it [00:02, 711.68it/s]warmup run: 1895it [00:02, 681.70it/s]warmup run: 1965it [00:03, 710.29it/s]warmup run: 1948it [00:03, 735.24it/s]warmup run: 1948it [00:03, 717.25it/s]warmup run: 1964it [00:03, 676.10it/s]warmup run: 2037it [00:03, 705.07it/s]warmup run: 2022it [00:03, 731.77it/s]warmup run: 2020it [00:03, 710.70it/s]warmup run: 2032it [00:03, 674.28it/s]warmup run: 2108it [00:03, 690.33it/s]warmup run: 2096it [00:03, 725.10it/s]warmup run: 2092it [00:03, 704.59it/s]warmup run: 2102it [00:03, 678.99it/s]warmup run: 2178it [00:03, 679.81it/s]warmup run: 2169it [00:03, 720.61it/s]warmup run: 2163it [00:03, 697.36it/s]warmup run: 2173it [00:03, 687.13it/s]warmup run: 2247it [00:03, 681.96it/s]warmup run: 2242it [00:03, 723.12it/s]warmup run: 2236it [00:03, 704.83it/s]warmup run: 2244it [00:03, 692.65it/s]warmup run: 2321it [00:03, 698.05it/s]warmup run: 2315it [00:03, 718.08it/s]warmup run: 2312it [00:03, 719.97it/s]warmup run: 2323it [00:03, 720.99it/s]warmup run: 2391it [00:03, 685.96it/s]warmup run: 2392it [00:03, 732.01it/s]warmup run: 2385it [00:03, 710.58it/s]warmup run: 2396it [00:03, 722.97it/s]warmup run: 2466it [00:03, 733.89it/s]warmup run: 2462it [00:03, 690.60it/s]warmup run: 2457it [00:03, 713.16it/s]warmup run: 2472it [00:03, 733.71it/s]warmup run: 2540it [00:03, 733.41it/s]warmup run: 2532it [00:03, 692.85it/s]warmup run: 2529it [00:03, 714.50it/s]warmup run: 2550it [00:03, 745.57it/s]warmup run: 2615it [00:03, 737.72it/s]warmup run: 2602it [00:03, 693.31it/s]warmup run: 2606it [00:03, 729.95it/s]warmup run: 2628it [00:03, 753.77it/s]warmup run: 2689it [00:04, 737.56it/s]warmup run: 2673it [00:04, 697.24it/s]warmup run: 2689it [00:04, 758.14it/s]warmup run: 2706it [00:04, 759.07it/s]warmup run: 2771it [00:04, 760.49it/s]warmup run: 2745it [00:04, 701.85it/s]warmup run: 2765it [00:04, 751.69it/s]warmup run: 2784it [00:04, 763.29it/s]warmup run: 2848it [00:04, 752.84it/s]warmup run: 2816it [00:04, 695.70it/s]warmup run: 2841it [00:04, 743.88it/s]warmup run: 2866it [00:04, 776.77it/s]warmup run: 2887it [00:04, 698.81it/s]warmup run: 2924it [00:04, 739.48it/s]warmup run: 2916it [00:04, 711.50it/s]warmup run: 2944it [00:04, 744.48it/s]warmup run: 2962it [00:04, 713.02it/s]warmup run: 2999it [00:04, 739.34it/s]warmup run: 2989it [00:04, 716.14it/s]warmup run: 3019it [00:04, 737.95it/s]warmup run: 3034it [00:04, 712.61it/s]warmup run: 3073it [00:04, 723.59it/s]warmup run: 3061it [00:04, 712.14it/s]warmup run: 3093it [00:04, 732.23it/s]warmup run: 3106it [00:04, 714.67it/s]warmup run: 3148it [00:04, 728.79it/s]warmup run: 3133it [00:04, 711.88it/s]warmup run: 3169it [00:04, 739.26it/s]warmup run: 3178it [00:04, 703.28it/s]warmup run: 3221it [00:04, 703.71it/s]warmup run: 3205it [00:04, 700.88it/s]warmup run: 3244it [00:04, 736.19it/s]warmup run: 3249it [00:04, 699.80it/s]warmup run: 3292it [00:04, 696.53it/s]warmup run: 3277it [00:04, 705.23it/s]warmup run: 3318it [00:04, 730.75it/s]warmup run: 3323it [00:04, 708.83it/s]warmup run: 3365it [00:04, 705.13it/s]warmup run: 3351it [00:05, 714.75it/s]warmup run: 3392it [00:05, 710.35it/s]warmup run: 3394it [00:05, 702.78it/s]warmup run: 3436it [00:05, 702.28it/s]warmup run: 3425it [00:05, 721.21it/s]warmup run: 3464it [00:05, 707.35it/s]warmup run: 3468it [00:05, 711.73it/s]warmup run: 3498it [00:05, 722.91it/s]warmup run: 3507it [00:05, 677.90it/s]warmup run: 3535it [00:05, 687.95it/s]warmup run: 3540it [00:05, 710.87it/s]warmup run: 3571it [00:05, 723.45it/s]warmup run: 3575it [00:05, 655.58it/s]warmup run: 3604it [00:05, 671.43it/s]warmup run: 3612it [00:05, 700.82it/s]warmup run: 3644it [00:05, 724.62it/s]warmup run: 3650it [00:05, 679.62it/s]warmup run: 3672it [00:05, 667.01it/s]warmup run: 3683it [00:05, 701.77it/s]warmup run: 3717it [00:05, 719.53it/s]warmup run: 3719it [00:05, 672.89it/s]warmup run: 3739it [00:05, 665.50it/s]warmup run: 3754it [00:05, 694.38it/s]warmup run: 3790it [00:05, 720.17it/s]warmup run: 3789it [00:05, 678.40it/s]warmup run: 3807it [00:05, 666.52it/s]warmup run: 3824it [00:05, 680.75it/s]warmup run: 3864it [00:05, 723.02it/s]warmup run: 3861it [00:05, 687.97it/s]warmup run: 3875it [00:05, 668.75it/s]warmup run: 3895it [00:05, 688.12it/s]warmup run: 3937it [00:05, 720.60it/s]warmup run: 3931it [00:05, 690.59it/s]warmup run: 3948it [00:05, 685.10it/s]warmup run: 3968it [00:05, 697.03it/s]warmup run: 4000it [00:05, 677.38it/s]warmup run: 4000it [00:05, 674.63it/s]warmup run: 4000it [00:05, 672.33it/s]warmup run: 4000it [00:05, 671.12it/s]
warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]


warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   5%|▍         | 181/4000 [00:00<00:02, 1807.52it/s]warmup should be done:   4%|▍         | 169/4000 [00:00<00:02, 1685.67it/s]warmup should be done:   4%|▍         | 173/4000 [00:00<00:02, 1724.32it/s]warmup should be done:   4%|▍         | 176/4000 [00:00<00:02, 1751.85it/s]warmup should be done:   9%|▊         | 347/4000 [00:00<00:02, 1739.42it/s]warmup should be done:   9%|▉         | 364/4000 [00:00<00:02, 1815.55it/s]warmup should be done:   9%|▉         | 354/4000 [00:00<00:02, 1771.92it/s]warmup should be done:   9%|▉         | 352/4000 [00:00<00:02, 1752.02it/s]warmup should be done:  13%|█▎        | 522/4000 [00:00<00:01, 1743.17it/s]warmup should be done:  13%|█▎        | 532/4000 [00:00<00:01, 1771.47it/s]warmup should be done:  14%|█▎        | 546/4000 [00:00<00:01, 1810.96it/s]warmup should be done:  13%|█▎        | 528/4000 [00:00<00:01, 1736.89it/s]warmup should be done:  18%|█▊        | 703/4000 [00:00<00:01, 1767.30it/s]warmup should be done:  18%|█▊        | 711/4000 [00:00<00:01, 1776.61it/s]warmup should be done:  18%|█▊        | 728/4000 [00:00<00:01, 1807.68it/s]warmup should be done:  18%|█▊        | 702/4000 [00:00<00:01, 1733.48it/s]warmup should be done:  22%|██▏       | 884/4000 [00:00<00:01, 1781.14it/s]warmup should be done:  23%|██▎       | 909/4000 [00:00<00:01, 1803.95it/s]warmup should be done:  22%|██▏       | 876/4000 [00:00<00:01, 1731.07it/s]warmup should be done:  22%|██▏       | 889/4000 [00:00<00:01, 1738.18it/s]warmup should be done:  27%|██▋       | 1065/4000 [00:00<00:01, 1788.61it/s]warmup should be done:  27%|██▋       | 1090/4000 [00:00<00:01, 1804.62it/s]warmup should be done:  26%|██▋       | 1050/4000 [00:00<00:01, 1730.30it/s]warmup should be done:  27%|██▋       | 1069/4000 [00:00<00:01, 1756.19it/s]warmup should be done:  31%|███       | 1246/4000 [00:00<00:01, 1795.56it/s]warmup should be done:  32%|███▏      | 1271/4000 [00:00<00:01, 1806.27it/s]warmup should be done:  31%|███       | 1224/4000 [00:00<00:01, 1732.01it/s]warmup should be done:  31%|███       | 1249/4000 [00:00<00:01, 1767.36it/s]warmup should be done:  36%|███▌      | 1427/4000 [00:00<00:01, 1799.50it/s]warmup should be done:  36%|███▋      | 1452/4000 [00:00<00:01, 1804.27it/s]warmup should be done:  35%|███▍      | 1398/4000 [00:00<00:01, 1730.47it/s]warmup should be done:  36%|███▌      | 1428/4000 [00:00<00:01, 1774.47it/s]warmup should be done:  40%|████      | 1607/4000 [00:00<00:01, 1789.99it/s]warmup should be done:  41%|████      | 1633/4000 [00:00<00:01, 1805.80it/s]warmup should be done:  39%|███▉      | 1572/4000 [00:00<00:01, 1728.75it/s]warmup should be done:  40%|████      | 1608/4000 [00:00<00:01, 1780.40it/s]warmup should be done:  45%|████▍     | 1788/4000 [00:01<00:01, 1794.06it/s]warmup should be done:  45%|████▌     | 1814/4000 [00:01<00:01, 1805.85it/s]warmup should be done:  44%|████▎     | 1745/4000 [00:01<00:01, 1728.45it/s]warmup should be done:  45%|████▍     | 1787/4000 [00:01<00:01, 1782.45it/s]warmup should be done:  49%|████▉     | 1968/4000 [00:01<00:01, 1789.33it/s]warmup should be done:  50%|████▉     | 1995/4000 [00:01<00:01, 1786.12it/s]warmup should be done:  48%|████▊     | 1918/4000 [00:01<00:01, 1722.03it/s]warmup should be done:  49%|████▉     | 1966/4000 [00:01<00:01, 1784.29it/s]warmup should be done:  54%|█████▎    | 2149/4000 [00:01<00:01, 1793.18it/s]warmup should be done:  54%|█████▎    | 2146/4000 [00:01<00:01, 1786.66it/s]warmup should be done:  52%|█████▏    | 2091/4000 [00:01<00:01, 1710.01it/s]warmup should be done:  54%|█████▍    | 2174/4000 [00:01<00:01, 1765.98it/s]warmup should be done:  58%|█████▊    | 2325/4000 [00:01<00:00, 1786.03it/s]warmup should be done:  58%|█████▊    | 2329/4000 [00:01<00:00, 1753.93it/s]warmup should be done:  57%|█████▋    | 2263/4000 [00:01<00:01, 1702.44it/s]warmup should be done:  59%|█████▉    | 2351/4000 [00:01<00:00, 1751.18it/s]warmup should be done:  63%|██████▎   | 2505/4000 [00:01<00:00, 1788.42it/s]warmup should be done:  63%|██████▎   | 2509/4000 [00:01<00:00, 1766.91it/s]warmup should be done:  61%|██████    | 2434/4000 [00:01<00:00, 1702.77it/s]warmup should be done:  63%|██████▎   | 2527/4000 [00:01<00:00, 1744.84it/s]warmup should be done:  67%|██████▋   | 2684/4000 [00:01<00:00, 1788.07it/s]warmup should be done:  65%|██████▌   | 2610/4000 [00:01<00:00, 1719.33it/s]warmup should be done:  67%|██████▋   | 2686/4000 [00:01<00:00, 1757.44it/s]warmup should be done:  68%|██████▊   | 2702/4000 [00:01<00:00, 1743.69it/s]warmup should be done:  72%|███████▏  | 2864/4000 [00:01<00:00, 1789.21it/s]warmup should be done:  70%|██████▉   | 2782/4000 [00:01<00:00, 1718.60it/s]warmup should be done:  72%|███████▏  | 2865/4000 [00:01<00:00, 1766.75it/s]warmup should be done:  72%|███████▏  | 2878/4000 [00:01<00:00, 1746.08it/s]warmup should be done:  76%|███████▌  | 3043/4000 [00:01<00:00, 1781.70it/s]warmup should be done:  76%|███████▌  | 3045/4000 [00:01<00:00, 1774.40it/s]warmup should be done:  76%|███████▋  | 3054/4000 [00:01<00:00, 1750.18it/s]warmup should be done:  74%|███████▍  | 2954/4000 [00:01<00:00, 1682.03it/s]warmup should be done:  81%|████████  | 3222/4000 [00:01<00:00, 1772.92it/s]warmup should be done:  81%|████████  | 3225/4000 [00:01<00:00, 1779.08it/s]warmup should be done:  81%|████████  | 3230/4000 [00:01<00:00, 1745.41it/s]warmup should be done:  78%|███████▊  | 3126/4000 [00:01<00:00, 1692.29it/s]warmup should be done:  85%|████████▌ | 3406/4000 [00:01<00:00, 1785.96it/s]warmup should be done:  85%|████████▌ | 3400/4000 [00:01<00:00, 1763.93it/s]warmup should be done:  85%|████████▌ | 3411/4000 [00:01<00:00, 1763.15it/s]warmup should be done:  82%|████████▎ | 3300/4000 [00:01<00:00, 1703.65it/s]warmup should be done:  90%|████████▉ | 3586/4000 [00:02<00:00, 1790.07it/s]warmup should be done:  89%|████████▉ | 3577/4000 [00:02<00:00, 1753.75it/s]warmup should be done:  90%|████████▉ | 3592/4000 [00:02<00:00, 1775.42it/s]warmup should be done:  87%|████████▋ | 3475/4000 [00:02<00:00, 1716.00it/s]warmup should be done:  94%|█████████▍| 3766/4000 [00:02<00:00, 1790.42it/s]warmup should be done:  94%|█████████▍| 3770/4000 [00:02<00:00, 1774.84it/s]warmup should be done:  94%|█████████▍| 3753/4000 [00:02<00:00, 1745.97it/s]warmup should be done:  91%|█████████ | 3648/4000 [00:02<00:00, 1719.56it/s]warmup should be done:  99%|█████████▊| 3946/4000 [00:02<00:00, 1792.08it/s]warmup should be done:  99%|█████████▉| 3950/4000 [00:02<00:00, 1782.02it/s]warmup should be done:  98%|█████████▊| 3928/4000 [00:02<00:00, 1744.21it/s]warmup should be done:  96%|█████████▌| 3826/4000 [00:02<00:00, 1735.80it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1779.64it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1779.28it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1767.76it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1723.49it/s]


warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]
warmup should be done:   0%|          | 0/4000 [00:00<?, ?it/s]warmup should be done:   5%|▍         | 182/4000 [00:00<00:02, 1817.33it/s]warmup should be done:   4%|▍         | 173/4000 [00:00<00:02, 1728.31it/s]warmup should be done:   4%|▍         | 172/4000 [00:00<00:02, 1714.78it/s]warmup should be done:   4%|▍         | 166/4000 [00:00<00:02, 1657.91it/s]warmup should be done:   9%|▉         | 365/4000 [00:00<00:01, 1822.33it/s]warmup should be done:   9%|▉         | 354/4000 [00:00<00:02, 1788.29it/s]warmup should be done:   9%|▉         | 358/4000 [00:00<00:02, 1798.79it/s]warmup should be done:   9%|▉         | 360/4000 [00:00<00:02, 1807.11it/s]warmup should be done:  13%|█▎        | 535/4000 [00:00<00:01, 1797.30it/s]warmup should be done:  14%|█▎        | 549/4000 [00:00<00:01, 1827.88it/s]warmup should be done:  14%|█▎        | 547/4000 [00:00<00:01, 1834.36it/s]warmup should be done:  14%|█▎        | 545/4000 [00:00<00:01, 1827.79it/s]warmup should be done:  18%|█▊        | 733/4000 [00:00<00:01, 1829.66it/s]warmup should be done:  18%|█▊        | 721/4000 [00:00<00:01, 1818.47it/s]warmup should be done:  18%|█▊        | 735/4000 [00:00<00:01, 1849.67it/s]warmup should be done:  18%|█▊        | 732/4000 [00:00<00:01, 1840.98it/s]warmup should be done:  23%|██▎       | 906/4000 [00:00<00:01, 1829.58it/s]warmup should be done:  23%|██▎       | 917/4000 [00:00<00:01, 1830.97it/s]warmup should be done:  23%|██▎       | 923/4000 [00:00<00:01, 1857.28it/s]warmup should be done:  23%|██▎       | 917/4000 [00:00<00:01, 1827.20it/s]warmup should be done:  27%|██▋       | 1091/4000 [00:00<00:01, 1836.28it/s]warmup should be done:  28%|██▊       | 1109/4000 [00:00<00:01, 1857.23it/s]warmup should be done:  28%|██▊       | 1101/4000 [00:00<00:01, 1830.60it/s]warmup should be done:  28%|██▊       | 1100/4000 [00:00<00:01, 1810.51it/s]warmup should be done:  32%|███▏      | 1277/4000 [00:00<00:01, 1841.32it/s]warmup should be done:  32%|███▏      | 1285/4000 [00:00<00:01, 1830.06it/s]warmup should be done:  32%|███▏      | 1295/4000 [00:00<00:01, 1844.04it/s]warmup should be done:  32%|███▏      | 1282/4000 [00:00<00:01, 1773.92it/s]warmup should be done:  37%|███▋      | 1469/4000 [00:00<00:01, 1830.92it/s]warmup should be done:  37%|███▋      | 1483/4000 [00:00<00:01, 1852.45it/s]warmup should be done:  37%|███▋      | 1462/4000 [00:00<00:01, 1818.75it/s]warmup should be done:  37%|███▋      | 1463/4000 [00:00<00:01, 1783.90it/s]warmup should be done:  41%|████▏     | 1654/4000 [00:00<00:01, 1834.37it/s]warmup should be done:  42%|████▏     | 1669/4000 [00:00<00:01, 1852.37it/s]warmup should be done:  41%|████      | 1648/4000 [00:00<00:01, 1829.28it/s]warmup should be done:  41%|████      | 1647/4000 [00:00<00:01, 1800.05it/s]warmup should be done:  46%|████▌     | 1839/4000 [00:01<00:01, 1837.03it/s]warmup should be done:  46%|████▋     | 1857/4000 [00:01<00:01, 1860.09it/s]warmup should be done:  46%|████▌     | 1834/4000 [00:01<00:01, 1836.92it/s]warmup should be done:  46%|████▌     | 1831/4000 [00:01<00:01, 1812.00it/s]warmup should be done:  51%|█████     | 2024/4000 [00:01<00:01, 1838.43it/s]warmup should be done:  51%|█████     | 2045/4000 [00:01<00:01, 1865.25it/s]warmup should be done:  50%|█████     | 2019/4000 [00:01<00:01, 1839.87it/s]warmup should be done:  50%|█████     | 2013/4000 [00:01<00:01, 1812.19it/s]warmup should be done:  56%|█████▌    | 2233/4000 [00:01<00:00, 1867.23it/s]warmup should be done:  55%|█████▌    | 2204/4000 [00:01<00:00, 1840.67it/s]warmup should be done:  55%|█████▌    | 2208/4000 [00:01<00:00, 1804.14it/s]warmup should be done:  55%|█████▍    | 2195/4000 [00:01<00:00, 1808.05it/s]warmup should be done:  60%|██████    | 2420/4000 [00:01<00:00, 1862.86it/s]warmup should be done:  60%|█████▉    | 2394/4000 [00:01<00:00, 1820.64it/s]warmup should be done:  60%|█████▉    | 2389/4000 [00:01<00:00, 1820.91it/s]warmup should be done:  59%|█████▉    | 2376/4000 [00:01<00:00, 1806.42it/s]warmup should be done:  65%|██████▌   | 2608/4000 [00:01<00:00, 1865.87it/s]warmup should be done:  65%|██████▍   | 2581/4000 [00:01<00:00, 1832.63it/s]warmup should be done:  64%|██████▍   | 2572/4000 [00:01<00:00, 1823.39it/s]warmup should be done:  64%|██████▍   | 2557/4000 [00:01<00:00, 1807.30it/s]warmup should be done:  70%|██████▉   | 2795/4000 [00:01<00:00, 1866.32it/s]warmup should be done:  69%|██████▉   | 2757/4000 [00:01<00:00, 1830.57it/s]warmup should be done:  69%|██████▉   | 2768/4000 [00:01<00:00, 1840.83it/s]warmup should be done:  68%|██████▊   | 2738/4000 [00:01<00:00, 1807.78it/s]warmup should be done:  75%|███████▍  | 2982/4000 [00:01<00:00, 1859.11it/s]warmup should be done:  74%|███████▎  | 2942/4000 [00:01<00:00, 1835.67it/s]warmup should be done:  74%|███████▍  | 2955/4000 [00:01<00:00, 1847.15it/s]warmup should be done:  73%|███████▎  | 2919/4000 [00:01<00:00, 1807.79it/s]warmup should be done:  79%|███████▉  | 3168/4000 [00:01<00:00, 1858.83it/s]warmup should be done:  78%|███████▊  | 3126/4000 [00:01<00:00, 1834.90it/s]warmup should be done:  79%|███████▊  | 3142/4000 [00:01<00:00, 1851.84it/s]warmup should be done:  78%|███████▊  | 3100/4000 [00:01<00:00, 1806.01it/s]warmup should be done:  84%|████████▍ | 3354/4000 [00:01<00:00, 1855.19it/s]warmup should be done:  83%|████████▎ | 3328/4000 [00:01<00:00, 1852.55it/s]warmup should be done:  83%|████████▎ | 3310/4000 [00:01<00:00, 1827.66it/s]warmup should be done:  82%|████████▏ | 3281/4000 [00:01<00:00, 1803.93it/s]warmup should be done:  88%|████████▊ | 3540/4000 [00:01<00:00, 1854.50it/s]warmup should be done:  88%|████████▊ | 3515/4000 [00:01<00:00, 1855.35it/s]warmup should be done:  87%|████████▋ | 3493/4000 [00:01<00:00, 1818.73it/s]warmup should be done:  87%|████████▋ | 3462/4000 [00:01<00:00, 1804.87it/s]warmup should be done:  93%|█████████▎| 3728/4000 [00:02<00:00, 1859.86it/s]warmup should be done:  93%|█████████▎| 3701/4000 [00:02<00:00, 1856.26it/s]warmup should be done:  92%|█████████▏| 3677/4000 [00:02<00:00, 1823.07it/s]warmup should be done:  91%|█████████ | 3644/4000 [00:02<00:00, 1808.51it/s]warmup should be done:  98%|█████████▊| 3916/4000 [00:02<00:00, 1865.58it/s]warmup should be done:  97%|█████████▋| 3888/4000 [00:02<00:00, 1859.63it/s]warmup should be done:  96%|█████████▋| 3860/4000 [00:02<00:00, 1819.81it/s]warmup should be done:  96%|█████████▌| 3825/4000 [00:02<00:00, 1808.00it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1855.96it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1840.09it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1823.09it/s]warmup should be done: 100%|██████████| 4000/4000 [00:02<00:00, 1805.64it/s]
WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fc1d3179970>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fc2d1040a30>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fc1d3179ac0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert

WARNING:tensorflow:AutoGraph could not transform <bound method DCNHPS.call of <tensorflow.python.eager.function.TfMethodTarget object at 0x7fc1d31799a0>> and will run it as-is.
Cause: mangled names are not yet supported
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
[HCTR][17:25:11.292][ERROR][RK0][tid #140456872621824]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][17:25:11.297][ERROR][RK0][tid #140456872621824]: coll ps creation done
[HCTR][17:25:11.351][ERROR][RK0][tid #140456881014528]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][17:25:11.357][ERROR][RK0][tid #140456881014528]: coll ps creation done
[HCTR][17:25:11.382][ERROR][RK0][tid #140456931337984]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][17:25:11.388][ERROR][RK0][tid #140456931337984]: coll ps creation done
[HCTR][17:25:11.471][ERROR][RK0][main]: coll ps creation, with 4 devices, using policy coll_cache_asymm_link
[HCTR][17:25:11.477][ERROR][RK0][main]: coll ps creation done
[HCTR][17:25:11.477][ERROR][RK0][tid #140456881014528]: replica 0 preparing frequency
[2023-04-14 17:25:11.477679: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506420 into 0
[2023-04-14 17:25:11.486236: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16096740
[2023-04-14 17:25:11.486448: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 507207 into 506420
[2023-04-14 17:25:11.489057: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 18562884
[2023-04-14 17:25:11.489233: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505205 into 1013627
[2023-04-14 17:25:11.491806: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 29302162
[2023-04-14 17:25:11.491982: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506136 into 1518832
[2023-04-14 17:25:11.494640: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 26139476
[2023-04-14 17:25:11.494926: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505398 into 2024968
[2023-04-14 17:25:11.497488: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19260545
[2023-04-14 17:25:11.497663: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504794 into 2530366
[2023-04-14 17:25:11.500223: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 30890472
[2023-04-14 17:25:11.500398: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505406 into 3035160
[2023-04-14 17:25:11.503032: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19318898
[2023-04-14 17:25:11.503306: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504793 into 3540566
[2023-04-14 17:25:11.505888: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16628166
[2023-04-14 17:25:11.506060: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505572 into 4045359
[2023-04-14 17:25:11.508717: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16550811
[2023-04-14 17:25:11.508981: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504900 into 4550931
[2023-04-14 17:25:11.511575: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 20241846
[HCTR][17:25:11.511][ERROR][RK0][main]: replica 1 preparing frequency
[2023-04-14 17:25:11.511777: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505919 into 5055831
[2023-04-14 17:25:11.514380: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16101633
[2023-04-14 17:25:11.514529: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506593 into 5561750
[2023-04-14 17:25:11.517084: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 18552515
[2023-04-14 17:25:11.517229: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505327 into 6068343
[2023-04-14 17:25:11.519837: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 29301332
[2023-04-14 17:25:11.519997: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506187 into 6573670
[2023-04-14 17:25:11.522637: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 26136012
[2023-04-14 17:25:11.522907: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505901 into 7079857
[2023-04-14 17:25:11.525523: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19265129
[2023-04-14 17:25:11.525758: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505571 into 7585758
[2023-04-14 17:25:11.528322: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 30883844
[2023-04-14 17:25:11.528467: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505720 into 8091329
[2023-04-14 17:25:11.531088: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19315166
[2023-04-14 17:25:11.531269: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504944 into 8597049
[2023-04-14 17:25:11.533893: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16632782
[2023-04-14 17:25:11.534168: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504820 into 9101993
[2023-04-14 17:25:11.536727: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16553594
[2023-04-14 17:25:11.536896: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505016 into 9606813
[2023-04-14 17:25:11.539502: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 20249993
[HCTR][17:25:11.539][ERROR][RK0][tid #140456931337984]: replica 2 preparing frequency
[2023-04-14 17:25:11.539707: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506873 into 10111829
[2023-04-14 17:25:11.542305: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16100404
[2023-04-14 17:25:11.542479: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506443 into 10618702
[2023-04-14 17:25:11.545054: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 18553445
[2023-04-14 17:25:11.545227: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504576 into 11125145
[2023-04-14 17:25:11.547831: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 29306042
[2023-04-14 17:25:11.548005: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506049 into 11629721
[2023-04-14 17:25:11.550587: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 26132673
[2023-04-14 17:25:11.550793: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 504567 into 12135770
[2023-04-14 17:25:11.553481: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19264202
[2023-04-14 17:25:11.553650: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505275 into 12640337
[2023-04-14 17:25:11.556224: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 30892607
[2023-04-14 17:25:11.556399: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506474 into 13145612
[2023-04-14 17:25:11.558965: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19315767
[2023-04-14 17:25:11.559140: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505642 into 13652086
[2023-04-14 17:25:11.561692: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16629343
[2023-04-14 17:25:11.561864: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505348 into 14157728
[2023-04-14 17:25:11.564439: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16548017
[2023-04-14 17:25:11.564611: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505835 into 14663076
[2023-04-14 17:25:11.567175: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 20249500
[HCTR][17:25:11.567][ERROR][RK0][tid #140456872621824]: replica 3 preparing frequency
[2023-04-14 17:25:11.567404: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506615 into 15168911
[2023-04-14 17:25:11.570007: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16095683
[2023-04-14 17:25:11.570167: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505824 into 15675526
[2023-04-14 17:25:11.573834: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 18553842
[2023-04-14 17:25:11.573995: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 503719 into 16181350
[2023-04-14 17:25:11.577674: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 29304109
[2023-04-14 17:25:11.577844: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505976 into 16685069
[2023-04-14 17:25:11.581434: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 26128937
[2023-04-14 17:25:11.581612: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505282 into 17191045
[2023-04-14 17:25:11.590796: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19265045
[2023-04-14 17:25:11.590985: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505152 into 17696327
[2023-04-14 17:25:11.594567: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 30890648
[2023-04-14 17:25:11.594737: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 506736 into 18201479
[2023-04-14 17:25:11.598323: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 19314006
[2023-04-14 17:25:11.598490: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505550 into 18708215
[2023-04-14 17:25:11.602082: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16637527
[2023-04-14 17:25:11.602245: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505162 into 19213765
[2023-04-14 17:25:11.604858: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 16553626
[2023-04-14 17:25:11.605029: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:337] bulk append 505236 into 19718927
[2023-04-14 17:25:11.608743: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:347] bulk append 20248577
[2023-04-14 17:25:11.608966: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:266] freq recorder global combining
[2023-04-14 17:25:13.246552: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:269] freq recorder global combine from 20224163 to 14453656
[2023-04-14 17:25:13.421323: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/freq_recorder.cc:286] top 5 freq is 28347903,16740847,16373799,15339422,13482819
[HCTR][17:25:13.450][ERROR][RK0][tid #140456881014528]: Calling build_v2
[HCTR][17:25:13.450][ERROR][RK0][main]: Calling build_v2
[HCTR][17:25:13.450][ERROR][RK0][tid #140456881014528]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][17:25:13.450][ERROR][RK0][tid #140456931337984]: Calling build_v2
[HCTR][17:25:13.450][ERROR][RK0][tid #140456872621824]: Calling build_v2
[HCTR][17:25:13.450][ERROR][RK0][main]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][17:25:13.450][ERROR][RK0][tid #140456931337984]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[HCTR][17:25:13.450][ERROR][RK0][tid #140456872621824]: cudaDevAttrCanUseHostPointerForRegisteredMem is 1
[2023-04-14 17:25:13.450341: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc:141] using concurrent impl MPSPhase
[[2023-04-14 17:25:132023-04-14 17:25:13..450385[450390: 2023-04-14 17:25:13: [E.E2023-04-14 17:25:13 450418 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc: /hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc450420E:::  141141E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc] ]  :using concurrent impl MPSPhaseusing concurrent impl MPSPhase/hugectr_dev/third_party/collcachelib/coll_cache_lib/run_config.cc409

:] 141before scale, dtype is 0, dim is 128[] [
2023-04-14 17:25:13using concurrent impl MPSPhase2023-04-14 17:25:13[.
.2023-04-14 17:25:13450599450597.: [: 450627E2023-04-14 17:25:13E:  . E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc450658/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc :: :/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc409E409:]  ] 415before scale, dtype is 0, dim is 128/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccbefore scale, dtype is 0, dim is 128] 
:
after scale, dtype is 7, new dim is 32409[
[] 2023-04-14 17:25:132023-04-14 17:25:13before scale, dtype is 0, dim is 128..
450825450833[: : 2023-04-14 17:25:13EE.  450884/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc: ::E415415 ] ] /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.ccafter scale, dtype is 7, new dim is 32after scale, dtype is 7, new dim is 32:

415] after scale, dtype is 7, new dim is 32
[2023-04-14 17:25:13.451652: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:207] assigning 8 to cpu
[2023-04-14 17:25:13.451724: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:224] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2023-04-14 17:25:13.451782: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:225] remote time is 9.21053
[2023-04-14 17:25:13.451824: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:226] cpu time is 31.8182
[2023-04-14 17:25:13.451880: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:425] registering cpu data with 16.00 GB
[2023-04-14 17:25:13.452121: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:207[] 2023-04-14 17:25:13assigning 8 to cpu.
452143: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:207] assigning 8 to cpu
[2023-04-14 17:25:13.452176: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:207] assigning 8 to cpu
[2023-04-14 17:25:13.452208: [E2023-04-14 17:25:13 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc452228:: 224E]  build symm link desc with 4X Tesla V100-SXM2-16GB out of 4/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
:224] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2023-04-14 17:25:13.[4522782023-04-14 17:25:13: .E452284 : /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.ccE: 225[/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] 2023-04-14 17:25:13:remote time is 9.21053.225
452299] : [remote time is 9.21053E2023-04-14 17:25:13
 ./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc[452352:2023-04-14 17:25:13: 224.E] 452384 build symm link desc with 4X Tesla V100-SXM2-16GB out of 4: /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc
E: 226/hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc] :cpu time is 31.8182226[
] 2023-04-14 17:25:13cpu time is 31.8182.
452463: [E2023-04-14 17:25:13 [./hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc2023-04-14 17:25:13452493:.: 225452510E] :  remote time is 9.21053E/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc
 :/hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc425:[] 4252023-04-14 17:25:13registering cpu data with 16.00 GB] .
registering cpu data with 16.00 GB452594
: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/asymm_link_desc.cc:226] cpu time is 31.8182
[2023-04-14 17:25:13.452688: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:425] registering cpu data with 16.00 GB
[2023-04-14 17:25:21.358967: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-14 17:25:21.359238: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:174] creating solver
[2023-04-14 17:25:21.359363: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:214] solver created. now build & solve
[2023-04-14 17:25:21.386159: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-14 17:25:21.404556: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-14 17:25:21.411237: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:427] registering cpu data done.
[2023-04-14 17:25:21.787354: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 3.29 GB
[2023-04-14 17:25:21.787482: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:309] reconfigured max freq to be 2.83479e+07
[2023-04-14 17:25:21.787513: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:311] reconfigured num slot to be 95
[2023-04-14 17:25:21.787542: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:318] counting slots...
[2023-04-14 17:25:24.665176: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:367] Final num slot is 108
[2023-04-14 17:25:24.665345: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:371] preparing block granularity...
[2023-04-14 17:25:24.665397: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 0 has 1 nodes, max_size set to 1, #slice=4
[2023-04-14 17:25:24.665438: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 2 has 1 nodes, max_size set to 1, #slice=4
[2023-04-14 17:25:24.665477: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 3 has 2 nodes, max_size set to 1, #slice=4
[2023-04-14 17:25:24.665516: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 4 has 10 nodes, max_size set to 3, #slice=4
[2023-04-14 17:25:24.665555: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 5 has 1 nodes, max_size set to 1, #slice=4
[2023-04-14 17:25:24.665595: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 6 has 1 nodes, max_size set to 1, #slice=4
[2023-04-14 17:25:24.665634: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 7 has 10 nodes, max_size set to 3, #slice=4
[2023-04-14 17:25:24.665673: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 8 has 2 nodes, max_size set to 1, #slice=4
[2023-04-14 17:25:24.665711: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 9 has 6 nodes, max_size set to 2, #slice=4
[2023-04-14 17:25:24.665750: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 10 has 7 nodes, max_size set to 2, #slice=4
[2023-04-14 17:25:24.665788: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 11 has 3 nodes, max_size set to 1, #slice=4
[2023-04-14 17:25:24.665827: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 12 has 7 nodes, max_size set to 2, #slice=4
[2023-04-14 17:25:24.665866: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 13 has 5 nodes, max_size set to 2, #slice=4
[2023-04-14 17:25:24.665904: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 14 has 11 nodes, max_size set to 3, #slice=4
[2023-04-14 17:25:24.665941: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 15 has 11 nodes, max_size set to 3, #slice=4
[2023-04-14 17:25:24.665981: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 16 has 3 nodes, max_size set to 1, #slice=4
[2023-04-14 17:25:24.666021: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 17 has 15 nodes, max_size set to 4, #slice=4
[2023-04-14 17:25:24.666059: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 18 has 14 nodes, max_size set to 4, #slice=4
[2023-04-14 17:25:24.666097: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 19 has 7 nodes, max_size set to 2, #slice=4
[2023-04-14 17:25:24.666150: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 20 has 19 nodes, max_size set to 5, #slice=4
[2023-04-14 17:25:24.666188: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 21 has 10 nodes, max_size set to 3, #slice=4
[2023-04-14 17:25:24.666227: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 22 has 21 nodes, max_size set to 6, #slice=4
[2023-04-14 17:25:24.666266: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 23 has 25 nodes, max_size set to 7, #slice=4
[2023-04-14 17:25:24.666304: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 24 has 29 nodes, max_size set to 8, #slice=4
[2023-04-14 17:25:24.666341: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 25 has 36 nodes, max_size set to 9, #slice=4
[2023-04-14 17:25:24.666381: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 26 has 51 nodes, max_size set to 13, #slice=4
[2023-04-14 17:25:24.666418: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 27 has 45 nodes, max_size set to 12, #slice=4
[2023-04-14 17:25:24.666455: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 28 has 50 nodes, max_size set to 13, #slice=4
[2023-04-14 17:25:24.666492: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 29 has 67 nodes, max_size set to 17, #slice=4
[2023-04-14 17:25:24.666541: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 30 has 100 nodes, max_size set to 25, #slice=4
[2023-04-14 17:25:24.666576: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 31 has 129 nodes, max_size set to 33, #slice=4
[2023-04-14 17:25:24.666611: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 32 has 120 nodes, max_size set to 30, #slice=4
[2023-04-14 17:25:24.666645: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 33 has 155 nodes, max_size set to 39, #slice=4
[2023-04-14 17:25:24.666684: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 34 has 174 nodes, max_size set to 44, #slice=4
[2023-04-14 17:25:24.666723: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 35 has 211 nodes, max_size set to 53, #slice=4
[2023-04-14 17:25:24.666762: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 36 has 264 nodes, max_size set to 66, #slice=4
[2023-04-14 17:25:24.666800: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 37 has 300 nodes, max_size set to 75, #slice=4
[2023-04-14 17:25:24.666838: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 38 has 304 nodes, max_size set to 76, #slice=4
[2023-04-14 17:25:24.666877: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 39 has 423 nodes, max_size set to 106, #slice=4
[2023-04-14 17:25:24.666917: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 40 has 462 nodes, max_size set to 116, #slice=4
[2023-04-14 17:25:24.666957: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 41 has 545 nodes, max_size set to 137, #slice=4
[2023-04-14 17:25:24.666998: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 42 has 719 nodes, max_size set to 180, #slice=4
[2023-04-14 17:25:24.667038: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 43 has 800 nodes, max_size set to 200, #slice=4
[2023-04-14 17:25:24.667088: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 44 has 867 nodes, max_size set to 217, #slice=4
[2023-04-14 17:25:24.667129: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 45 has 1045 nodes, max_size set to 262, #slice=4
[2023-04-14 17:25:24.667168: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 46 has 1168 nodes, max_size set to 292, #slice=4
[2023-04-14 17:25:24.667206: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 47 has 1284 nodes, max_size set to 321, #slice=4
[2023-04-14 17:25:24.667245: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 48 has 1489 nodes, max_size set to 373, #slice=4
[2023-04-14 17:25:24.667283: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 49 has 1776 nodes, max_size set to 444, #slice=4
[2023-04-14 17:25:24.667320: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 50 has 1871 nodes, max_size set to 468, #slice=4
[2023-04-14 17:25:24.667358: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 51 has 2174 nodes, max_size set to 544, #slice=4
[2023-04-14 17:25:24.667396: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 52 has 2404 nodes, max_size set to 601, #slice=4
[2023-04-14 17:25:24.667432: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 53 has 2690 nodes, max_size set to 673, #slice=4
[2023-04-14 17:25:24.667470: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 54 has 3126 nodes, max_size set to 782, #slice=4
[2023-04-14 17:25:24.667508: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 55 has 3397 nodes, max_size set to 850, #slice=4
[2023-04-14 17:25:24.667546: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 56 has 3774 nodes, max_size set to 944, #slice=4
[2023-04-14 17:25:24.667584: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 57 has 4350 nodes, max_size set to 1088, #slice=4
[2023-04-14 17:25:24.667622: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 58 has 5029 nodes, max_size set to 1258, #slice=4
[2023-04-14 17:25:24.667661: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 59 has 5746 nodes, max_size set to 1437, #slice=4
[2023-04-14 17:25:24.667698: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 60 has 5931 nodes, max_size set to 1483, #slice=4
[2023-04-14 17:25:24.667736: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 61 has 7482 nodes, max_size set to 1871, #slice=4
[2023-04-14 17:25:24.667773: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 62 has 7428 nodes, max_size set to 1857, #slice=4
[2023-04-14 17:25:24.667810: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 63 has 10331 nodes, max_size set to 2583, #slice=4
[2023-04-14 17:25:24.667848: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 64 has 9347 nodes, max_size set to 2337, #slice=4
[2023-04-14 17:25:24.667886: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 65 has 10689 nodes, max_size set to 2673, #slice=4
[2023-04-14 17:25:24.667923: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 66 has 12403 nodes, max_size set to 3101, #slice=4
[2023-04-14 17:25:24.667967: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 67 has 29178 nodes, max_size set to 7295, #slice=4
[2023-04-14 17:25:24.668005: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 68 has 14963 nodes, max_size set to 3741, #slice=4
[2023-04-14 17:25:24.668042: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 69 has 16467 nodes, max_size set to 4117, #slice=4
[2023-04-14 17:25:24.668080: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 70 has 20121 nodes, max_size set to 5031, #slice=4
[2023-04-14 17:25:24.668117: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 71 has 21254 nodes, max_size set to 5314, #slice=4
[2023-04-14 17:25:24.668154: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 72 has 23312 nodes, max_size set to 5828, #slice=4
[2023-04-14 17:25:24.668193: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 73 has 28326 nodes, max_size set to 7082, #slice=4
[2023-04-14 17:25:24.668231: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 74 has 34548 nodes, max_size set to 8637, #slice=4
[2023-04-14 17:25:24.668268: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 75 has 33321 nodes, max_size set to 8331, #slice=4
[2023-04-14 17:25:24.668305: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 76 has 46304 nodes, max_size set to 11576, #slice=4
[2023-04-14 17:25:24.668342: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 77 has 53615 nodes, max_size set to 13404, #slice=4
[2023-04-14 17:25:24.668380: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 78 has 55774 nodes, max_size set to 13944, #slice=4
[2023-04-14 17:25:24.668417: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 79 has 48855 nodes, max_size set to 12214, #slice=4
[2023-04-14 17:25:24.668454: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 80 has 106181 nodes, max_size set to 26546, #slice=4
[2023-04-14 17:25:24.668492: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 81 has 50032 nodes, max_size set to 12508, #slice=4
[2023-04-14 17:25:24.668531: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 82 has 138270 nodes, max_size set to 34568, #slice=4
[2023-04-14 17:25:24.668569: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 83 has 99960 nodes, max_size set to 24990, #slice=4
[2023-04-14 17:25:24.668607: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 84 has 136350 nodes, max_size set to 34088, #slice=4
[2023-04-14 17:25:24.668644: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 85 has 198562 nodes, max_size set to 49641, #slice=4
[2023-04-14 17:25:24.668681: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 86 has 319759 nodes, max_size set to 79940, #slice=4
[2023-04-14 17:25:24.668719: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 88 has 616193 nodes, max_size set to 154049, #slice=4
[2023-04-14 17:25:24.668757: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 90 has 1720402 nodes, max_size set to 430101, #slice=4
[2023-04-14 17:25:24.668799: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 93 has 10530932 nodes, max_size set to 882774, #slice=12
[2023-04-14 17:25:24.668837: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 94 has 8682781 nodes, max_size set to 882774, #slice=12
[2023-04-14 17:25:24.668874: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 95 has 8680765 nodes, max_size set to 882774, #slice=12
[2023-04-14 17:25:24.668912: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 96 has 8685953 nodes, max_size set to 882774, #slice=12
[2023-04-14 17:25:24.668949: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 97 has 8682030 nodes, max_size set to 882774, #slice=12
[2023-04-14 17:25:24.668986: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 98 has 8683074 nodes, max_size set to 882774, #slice=12
[2023-04-14 17:25:24.669024: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 99 has 8685589 nodes, max_size set to 882774, #slice=12
[2023-04-14 17:25:24.669068: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 100 has 8686120 nodes, max_size set to 882774, #slice=12
[2023-04-14 17:25:24.669106: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 101 has 8679773 nodes, max_size set to 8679773, #slice=1
[2023-04-14 17:25:24.669144: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 102 has 8683625 nodes, max_size set to 8683625, #slice=1
[2023-04-14 17:25:24.669182: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 103 has 8684020 nodes, max_size set to 8684020, #slice=1
[2023-04-14 17:25:24.669220: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 104 has 86838688 nodes, max_size set to 86838688, #slice=1
[2023-04-14 17:25:24.669257: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 105 has 86825356 nodes, max_size set to 86825356, #slice=1
[2023-04-14 17:25:24.669295: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 106 has 86829818 nodes, max_size set to 86829818, #slice=1
[2023-04-14 17:25:24.669333: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 107 has 86828649 nodes, max_size set to 86828649, #slice=1
[2023-04-14 17:25:24.669370: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 108 has 86838542 nodes, max_size set to 86838542, #slice=1
[2023-04-14 17:25:24.669407: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 109 has 86826742 nodes, max_size set to 86826742, #slice=1
[2023-04-14 17:25:24.669445: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 110 has 86842484 nodes, max_size set to 86842484, #slice=1
[2023-04-14 17:25:24.669484: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 111 has 86834097 nodes, max_size set to 86834097, #slice=1
[2023-04-14 17:25:24.669521: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 112 has 86822830 nodes, max_size set to 86822830, #slice=1
[2023-04-14 17:25:24.669558: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:405] counting blocks...
[2023-04-14 17:25:26. 49774: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:425] Final num block is 460
[2023-04-14 17:25:26. 49876: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:430] counting freq and density...
[2023-04-14 17:25:26.186546: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:479] averaging freq and density...
[2023-04-14 17:25:26.186669: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:480] 460
[2023-04-14 17:25:26.200533: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:218] solver built. now solve
[2023-04-14 17:25:26.200614: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:893] constructing optimal solver, device=4, stream=1
460 blocks, 4 devices
[2023-04-14 17:25:27.213283: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1078] Add Var...
[2023-04-14 17:25:27.220197: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1096] Capacity...
[2023-04-14 17:25:27.220720: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1099] Connect CPU...
[2023-04-14 17:25:27.227345: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1101] Connect Access To Storage...
[2023-04-14 17:25:27.267302: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1105] Time...
[2023-04-14 17:25:27.268051: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1067] dst 0, total sm is 80
[2023-04-14 17:25:27.269030: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1067] dst 1, total sm is 80
[2023-04-14 17:25:27.269998: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1067] dst 2, total sm is 80
[2023-04-14 17:25:27.270995: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1067] dst 3, total sm is 80
[2023-04-14 17:25:27.580937: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1124] Coll Cache init block placement array
[2023-04-14 17:25:27.582356: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1200] Coll Cache init block placement array done
[2023-04-14 17:25:27.582445: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/coll_cache/optimal_solver_class.cc:1202] Coll Cache model reset done
[2023-04-14 17:25:27.587908: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:222] solver solved
[2023-04-14 17:25:27.587984: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:437] 0 solved master
[2023-04-14 17:25:27.588018: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 0 solved
[2023-04-14 17:25:27.588048: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 0 initing device 0
[2023-04-14 17:25:27.589256: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-14 17:25:27.589681: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cuh:611] per src size local is 18935233
[2023-04-14 17:25:27.787004: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 2 solved
[2023-04-14 17:25:27.787214: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 2 initing device 2
[2023-04-14 17:25:27.789150: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-14 17:25:27.802561: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 3 solved
[2023-04-14 17:25:27.802654: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 3 initing device 3
[2023-04-14 17:25:27.803492: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-14 17:25:27.832317: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:444] 1 solved
[2023-04-14 17:25:27.832449: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/facade.cc:447] worker 0 thread 1 initing device 1
[2023-04-14 17:25:27.833283: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2320] Building Coll Cache with ... num gpu device is 4
[2023-04-14 17:25:27.880086: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 861805884
[2023-04-14 17:25:28.111236: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 861805884
[2023-04-14 17:25:28.135992: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 861805884
[2023-04-14 17:25:28.188415: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2362] num cpu nodes is 861805884
[2023-04-14 17:25:28.652617: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 20968708 possible elem, scale to 67108864
[2023-04-14 17:25:28.652725: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 512.00 MB
[2023-04-14 17:25:28.874478: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 20968708 possible elem, scale to 67108864
[2023-04-14 17:25:28.874587: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 512.00 MB
[2023-04-14 17:25:28.896053: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 20968708 possible elem, scale to 67108864
[2023-04-14 17:25:28.896173: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 512.00 MB
[2023-04-14 17:25:28.951453: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 20968708 possible elem, scale to 67108864
[2023-04-14 17:25:28.951536: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 512.00 MB
[2023-04-14 17:25:29.  1615: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?18538266->1324508
[2023-04-14 17:25:29.  2841: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?18538266->1452658
[2023-04-14 17:25:29.  9577: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?18538266->1764972
[2023-04-14 17:25:29. 12509: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?18538266->1188533
[2023-04-14 17:25:29. 26731: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: coll_cache_asymm_link) | local 17213758 / 882774592 nodes ( 1.95 %~2.00 %) | remote 3754950 / 882774592 nodes ( 0.43 %) | cpu 861805884 / 882774592 nodes ( 97.62 %) | 8.84 GB | 1.43743 secs 
[2023-04-14 17:25:29. 38693: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 12.04 GB
[2023-04-14 17:25:29. 42055: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 12.04 GB
[2023-04-14 17:25:29. 46655: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 12.04 GB
[2023-04-14 17:25:29. 52320: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] before create ctx, mem is 12.04 GB
[2023-04-14 17:25:29. 67330: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: coll_cache_asymm_link) | local 17349733 / 882774592 nodes ( 1.97 %~2.00 %) | remote 3618975 / 882774592 nodes ( 0.41 %) | cpu 861805884 / 882774592 nodes ( 97.62 %) | 8.84 GB | 1.23401 secs 
[2023-04-14 17:25:29. 70546: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: coll_cache_asymm_link) | local 16773294 / 882774592 nodes ( 1.90 %~2.00 %) | remote 4195414 / 882774592 nodes ( 0.48 %) | cpu 861805884 / 882774592 nodes ( 97.62 %) | 8.84 GB | 1.26702 secs 
[2023-04-14 17:25:29. 94560: E /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:2439] Asymm Coll cache (policy: coll_cache_asymm_link) | local 17085608 / 882774592 nodes ( 1.94 %~2.00 %) | remote 3883100 / 882774592 nodes ( 0.44 %) | cpu 861805884 / 882774592 nodes ( 97.62 %) | 8.84 GB | 1.30532 secs 
[2023-04-14 17:25:32.397569: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 12.93 GB
[2023-04-14 17:25:32.397753: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 12.93 GB
[2023-04-14 17:25:32.460726: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 12.95 GB
[2023-04-14 17:25:32.460877: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 12.95 GB
[2023-04-14 17:25:32.475426: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 12.95 GB
[2023-04-14 17:25:32.475641: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 12.95 GB
[2023-04-14 17:25:32.511251: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create ctx, mem is 12.96 GB
[2023-04-14 17:25:32.511416: W /hugectr_dev/third_party/collcachelib/coll_cache_lib/cache_context.cu:3958] after create stream, mem is 12.96 GB
