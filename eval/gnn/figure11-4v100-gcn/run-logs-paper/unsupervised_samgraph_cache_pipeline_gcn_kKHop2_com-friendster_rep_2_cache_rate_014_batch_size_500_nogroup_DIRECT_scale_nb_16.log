succeed=True
config:eval_tsp="2023-08-04 19:35:44"
config:arch=arch5
config:num_train_worker=3
config:num_sample_worker=1
config:sample_type=khop2
config:root_path=/datasets_gnn/gnnlab/
config:dataset=com-friendster
config:pipeline=True
config:cache_policy=rep
config:cache_percentage=0.14
config:num_epoch=4
config:batch_size=500
config:num_hidden=256
config:max_sampling_jobs=1
config:max_copying_jobs=1
config:barriered_epoch=1
config:presample_epoch=2
config:omp_thread_num=40
config:unsupervised=True
config:amp=True
config:rolling=0
config:fanout=[5, 10, 15]
config:lr=0.003
config:dropout=0.5
config:weight_decay=0.0005
config:single_gpu=False
config:max_num_step=1000
config:validate_configs=False
config:dataset_path=/datasets_gnn/gnnlab/com-friendster
config:torch_thread_num=13
config:train_workers=['cuda:0', 'cuda:1', 'cuda:2']
config:sample_workers=['cuda:3']
config:num_fanout=3
config:num_layer=3
config:_run_mode=RunMode.FGNN
config:_log_level=warn
config:_profile_level=3
config:_empty_feat=25
config:_arch=5
config:_sample_type=5
config:_cache_policy=12
test_result:init:input_scale_factor=1.11138
[Sample Worker 0/1] Started with PID 17377(Tesla V100-SXM2-16GB)
[Sample Worker 0] run sample for 4 epochs with 1002 steps
0 :  {link #0 : 1}, {link #1 : 2},
1 :  {link #0 : 2}, {link #1 : 0},
2 :  {link #0 : 0}, {link #1 : 1},
0 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g2 0},
1 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0},
2 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g1 0},
0 :  {link #0 : 1}, {link #1 : 2},
1 :  {link #0 : 2}, {link #1 : 0},
2 :  {link #0 : 0}, {link #1 : 1},
0 :  {link #0 : 1}, {link #1 : 2},
1 :  {link #0 : 2}, {link #1 : 0},
2 :  {link #0 : 0}, {link #1 : 1},
0 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g2 0},
1 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0},
2 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g1 0},
0 : local 80, cpu 0 {link #0 : g1 0}, {link #1 : g2 0},
1 : local 80, cpu 0 {link #0 : g2 0}, {link #1 : g0 0},
2 : local 80, cpu 0 {link #0 : g0 0}, {link #1 : g1 0},
coll_cache:optimal_rep_storage=0.14
coll_cache:optimal_part_storage=0
coll_cache:optimal_cpu_storage=0.86
coll_cache:optimal_local_storage=0.14
coll_cache:optimal_remote_storage=0
coll_cache:optimal_local_rate=0.707477
coll_cache:optimal_remote_rate=0
coll_cache:optimal_cpu_rate=0.292523
z=34002.2
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=9472797696
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=9472797696
test_result:init:feat_nbytes=67182966784
test_result:init:cache_nbytes=9472797696
[Train  Worker 1/3] Started with PID 17381(Tesla V100-SXM2-16GB)
[Train  Worker 1] run train for 4 epochs with 1002 steps
[Train  Worker 2/3] Started with PID 17383(Tesla V100-SXM2-16GB)
[Train  Worker 2] run train for 4 epochs with 1002 steps
[CUDA] cuda0: usage: 14.91 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 2.44 GB
[SAM] cuda0 workspace reserve : 1.20 GB
[SAM] cuda0 total             : 2.44 GB
[Train  Worker 0/3] Started with PID 17379(Tesla V100-SXM2-16GB)
[Train  Worker 0] run train for 4 epochs with 1002 steps
Epoch 00000 | Epoch Time 18.6127 | Total Train Time(Profiler) 18.5054 | Copy Time 13.2297
[CUDA] cuda3: usage: 14.71 GB
[SAM] cuda3 data alloc        : 74.57 MB
[SAM] cuda3 workspace         : 13.74 GB
[SAM] cuda3 workspace reserve : 39.38 MB
[SAM] cuda3 total             : 13.81 GB
[CUDA] cuda0: usage: 14.91 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 2.44 GB
[SAM] cuda0 workspace reserve : 1.20 GB
[SAM] cuda0 total             : 2.44 GB
Epoch 00001 | Epoch Time 16.9165 | Total Train Time(Profiler) 16.8235 | Copy Time 13.2258
[CUDA] cuda3: usage: 14.71 GB
[SAM] cuda3 data alloc        : 74.57 MB
[SAM] cuda3 workspace         : 13.74 GB
[SAM] cuda3 workspace reserve : 39.38 MB
[SAM] cuda3 total             : 13.81 GB
[CUDA] cuda0: usage: 14.91 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 2.44 GB
[SAM] cuda0 workspace reserve : 1.20 GB
[SAM] cuda0 total             : 2.44 GB
Epoch 00002 | Epoch Time 17.0665 | Total Train Time(Profiler) 16.9419 | Copy Time 13.2585
[CUDA] cuda3: usage: 14.71 GB
[SAM] cuda3 data alloc        : 74.57 MB
[SAM] cuda3 workspace         : 13.74 GB
[SAM] cuda3 workspace reserve : 39.38 MB
[SAM] cuda3 total             : 13.81 GB
[CUDA] cuda0: usage: 14.91 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 2.44 GB
[SAM] cuda0 workspace reserve : 1.20 GB
[SAM] cuda0 total             : 2.44 GB
Epoch 00003 | Epoch Time 16.9266 | Total Train Time(Profiler) 16.8346 | Copy Time 13.2241
[CUDA] cuda3: usage: 14.71 GB
[SAM] cuda3 data alloc        : 74.57 MB
[SAM] cuda3 workspace         : 13.74 GB
[SAM] cuda3 workspace reserve : 39.38 MB
[SAM] cuda3 total             : 13.81 GB
[Train  Worker 2] Avg Epoch Time 16.9698 | Train Total Time(Profiler) 16.8660 | Copy Time 13.2378
[Train  Worker 1] Avg Epoch Time 16.9698 | Train Total Time(Profiler) 16.8667 | Copy Time 13.2371
    [Step(average) Profiler Level 1 E3 S1001]
        L1  sample           0.005001 | send           0.001124
        L1  recv             0.001399 | copy           0.039632 | convert time 0.000579 | train  0.049929
        L1  feature nbytes    1.06 GB | label nbytes    3.91 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    9.46 MB
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes         1113389 | num samples     1238938
    [Step(average) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000032 | core sample  0.001987 | id remap        0.002810
        L2  graph copy  0.000005 | id copy      0.000000 | cache feat copy 0.038228
        L2  last layer sample time 0.000286 | size 20273.531448
    [Step(average) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.001702 | khop sort coo      0.000000 | khop count edge     0.000043 | khop compact edge 0.000170
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000157 | remap populate     0.002361 | remap mapnode       0.000000 | remap mapedge     0.000461
        L3  cache get_index  0.005418 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.031565 | cache combine remote 0.000000
        L3  label extract  0.000592
[Train  Worker 0] Avg Epoch Time 16.9699 | Train Total Time(Profiler) 16.8666 | Copy Time 13.2362
    [Init Profiler Level 1]
        L1  init    14.1842 | sampler init    84.3857 | trainer init 0.0000
    [Init Profiler Level 2]
        L2  load ds        16.5296 | init queue          62.1932
        L2  presample      18.1255 | build interal ds     1.7183
        L2  build cache     0.0000
    [Init Profiler Level 3]
        L3  load dataset: mmap    14.1813 | copy         2.3483
        L3  dist queue: alloc      0.0008 | pin         62.1924 | push     0.0000
        L3  presample: init        0.1855
        L3  presample: sample     10.0390 | copy         0.7044
        L3  presample: count       6.5700 | sort         0.2245
        L3  presample: reset       0.0020 | get rank     0.0199
        L3  internal: cuda ctx     1.4658 | cuda stream     0.2488
[CUDA] cuda3: usage: 14.71 GB
[SAM] cuda3 data alloc        : 74.57 MB
[SAM] cuda3 workspace         : 13.74 GB
[SAM] cuda3 workspace reserve : 39.38 MB
[SAM] cuda3 total             : 13.81 GB
[CUDA] cuda0: usage: 14.91 GB
[SAM] cuda0 data alloc        : 0.00 Bytes
[SAM] cuda0 workspace         : 2.44 GB
[SAM] cuda0 workspace reserve : 1.20 GB
[SAM] cuda0 total             : 2.44 GB
    [Step(average) Profiler Level 1 E3 S1001]
        L1  sample           0.005001 | send           0.001124
        L1  recv             0.001399 | copy           0.039632 | convert time 0.000579 | train  0.049929
        L1  feature nbytes    1.06 GB | label nbytes    3.91 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    9.46 MB
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes         1113389 | num samples     1238938
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000032 | core sample  0.001987 | id remap        0.002810
        L2  graph copy  0.000005 | id copy      0.000000 | cache feat copy 0.038228
        L2  last layer sample time 0.000286 | size 20273.531448
    [Step(average) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.001702 | khop sort coo      0.000000 | khop count edge     0.000043 | khop compact edge 0.000170
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000157 | remap populate     0.002361 | remap mapnode       0.000000 | remap mapedge     0.000461
        L3  cache get_index  0.005418 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.031565 | cache combine remote 0.000000
        L3  label extract  0.000592
    [Step(max) Profiler Level 1 E3 S1001]
        L1  sample           0.024881 | send           0.001434
        L1  recv             0.049837 | copy           0.078676 | convert time 0.001638 | train  0.060595
        L1  feature nbytes    1.09 GB | label nbytes    3.91 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    9.70 MB
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes         1140096 | num samples     1270113
    [Step(max) Profiler Level 2 E3 S1001]
        L2  shuffle     0.019857 | core sample  0.002489 | id remap        0.003451
        L2  graph copy  0.000024 | id copy      0.000000 | cache feat copy 0.077408
        L2  last layer sample time 0.000948 | size 20793.000000
    [Step(max) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.001975 | khop sort coo      0.000000 | khop count edge     0.000217 | khop compact edge 0.000572
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000352 | remap populate     0.003003 | remap mapnode       0.000000 | remap mapedge     0.000787
        L3  cache get_index  0.010031 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.034956 | cache combine remote 0.000000
        L3  label extract  0.009559
    [Step(min) Profiler Level 1 E3 S1001]
        L1  sample           0.004798 | send           0.001093
        L1  recv             0.001211 | copy           0.038444 | convert time 0.000540 | train  0.021218
        L1  feature nbytes    1.03 GB | label nbytes    3.91 KB
        L1  id nbytes      0.00 Bytes | graph nbytes    9.19 MB
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes         1083648 | num samples     1203590
    [Step(min) Profiler Level 2 E3 S1001]
        L2  shuffle     0.000012 | core sample  0.001890 | id remap        0.002710
        L2  graph copy  0.000003 | id copy      0.000000 | cache feat copy 0.027163
        L2  last layer sample time 0.000276 | size 19725.000000
    [Step(min) Profiler Level 3 E3 S1001]
        L3  khop sample coo  0.001615 | khop sort coo      0.000000 | khop count edge     0.000040 | khop compact edge 0.000162
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000149 | remap populate     0.002276 | remap mapnode       0.000000 | remap mapedge     0.000445
        L3  cache get_index  0.000723 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.026353 | cache combine remote 0.000000
        L3  label extract  0.000021
    [Init Profiler Level 1]
        L1  init    14.1842 | sampler init     0.0000 | trainer init 91.1824
    [Init Profiler Level 2]
        L2  load ds        14.1813 | init queue          62.1936
        L2  presample       0.0000 | build interal ds     1.4635
        L2  build cache    27.5163
    [Init Profiler Level 3]
        L3  load dataset: mmap    14.1813 | copy         0.0000
        L3  dist queue: alloc      0.0008 | pin         62.1928 | push     0.0000
        L3  presample: init        0.0000
        L3  presample: sample      0.0000 | copy         0.0000
        L3  presample: count       0.0000 | sort         0.0000
        L3  presample: reset       0.0000 | get rank     0.0000
        L3  internal: cuda ctx     1.4631 | cuda stream     0.0004
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    8038 KB |    1996 MB |    6220 GB |    6220 GB |
|       from large pool |       0 KB |    1995 MB |    6181 GB |    6181 GB |
|       from small pool |    8038 KB |      16 MB |      38 GB |      38 GB |
|---------------------------------------------------------------------------|
| Active memory         |    8038 KB |    1996 MB |    6220 GB |    6220 GB |
|       from large pool |       0 KB |    1995 MB |    6181 GB |    6181 GB |
|       from small pool |    8038 KB |      16 MB |      38 GB |      38 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2040 MB |    2040 MB |    2040 MB |       0 B  |
|       from large pool |    2018 MB |    2018 MB |    2018 MB |       0 B  |
|       from small pool |      22 MB |      22 MB |      22 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   10393 KB |    1624 MB |    8050 GB |    8050 GB |
|       from large pool |       0 KB |    1613 MB |    8010 GB |    8010 GB |
|       from small pool |   10393 KB |      14 MB |      39 GB |      39 GB |
|---------------------------------------------------------------------------|
| Allocations           |      42    |      78    |  295292    |  295250    |
|       from large pool |       0    |      15    |   94856    |   94856    |
|       from small pool |      42    |      66    |  200436    |  200394    |
|---------------------------------------------------------------------------|
| Active allocs         |      43    |      78    |  295292    |  295249    |
|       from large pool |       0    |      15    |   94856    |   94856    |
|       from small pool |      43    |      66    |  200436    |  200393    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      19    |      19    |      19    |       0    |
|       from large pool |       8    |       8    |       8    |       0    |
|       from small pool |      11    |      11    |      11    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      25    |      40    |  105981    |  105956    |
|       from large pool |       0    |      11    |   50400    |   50400    |
|       from small pool |      25    |      31    |   55581    |   55556    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

test_result:epoch_time:copy_time=13.2362
test_result:convert_time=0.1923
test_result:train_time=16.6743
test_result:epoch_time:train_total=16.8666
test_result:cache_percentage=0.1400
test_result:cache_hit_rate=1.0000
test_result:epoch_feat_nbytes=380838795605.3333
test_result:batch_feat_nbytes=1140235914.9860
test_result:epoch_miss_nbytes=0.0000
test_result:batch_miss_nbytes=0.0000
test_result:batch_copy_time=0.0396
test_result:batch_train_time=0.0505
test_result:pipeline_train_epoch_time=16.9699
test_result:run_time=69.5279
test_result:init:load_dataset:copy:trainer=0.0000
test_result:init:dist_queue:pin:trainer=62.1928
test_result:init:internal:trainer=1.4635
test_result:init:cache:trainer=27.5163
[Sample Worker 0] Avg Sample Total Time 6.1506 | Sampler Total Time(Profiler) 6.1373
test_result:sample_time=5.011391
test_result:get_cache_miss_index_time=0.000039
test_result:enqueue_samples_time=1.125820
test_result:epoch_time:sample_total=6.150619
test_result:pipeline_sample_epoch_time=16.970169
test_result:init:presample=18.125517
test_result:init:load_dataset:mmap=14.181292
test_result:init:load_dataset:copy:sampler=2.348295
test_result:init:dist_queue:alloc+push=0.000796
test_result:init:dist_queue:pin:sampler=62.192417
test_result:init:internal:sampler=1.718329
test_result:init:cache:sampler=0.000000

