[2023-08-04 19:42:02.557205: W /gnnlab/samgraph/common/cpu/mmap_cpu_device.cc:113] mmap allocating space 12.03 GB
[2023-08-04 19:42:02.557301: W /gnnlab/samgraph/common/cpu/mmap_cpu_device.cc:118] mmap allocating space 12.03 GB done
[2023-08-04 19:42:02.557331: E /gnnlab/samgraph/common/common.cc:229] From MMAP reading disk 12.03 GB
[2023-08-04 19:42:07.726639: E /gnnlab/samgraph/common/common.cc:243] From MMAP reading done
[2023-08-04 19:42:10.452467: W /gnnlab/samgraph/common/cpu/mmap_cpu_device.cc:113] mmap allocating space 20.71 GB
[2023-08-04 19:42:10.452591: W /gnnlab/samgraph/common/cpu/mmap_cpu_device.cc:118] mmap allocating space 20.71 GB done
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
[2023-08-04 19:42:10.663997: W /gnnlab/samgraph/common/dist/dist_engine.cc:687] Trainer[0] initializing...
[2023-08-04 19:42:10.712353: W /gnnlab/samgraph/common/dist/dist_engine.cc:687] Trainer[2] initializing...
[2023-08-04 19:42:10.718547: W /gnnlab/samgraph/common/dist/dist_engine.cc:687] Trainer[1] initializing...
[2023-08-04 19:42:12.116003: W /gnnlab/samgraph/common/dist/dist_engine.cc:691] Trainer[2] pin memory queue...
[2023-08-04 19:42:12.119333: W /gnnlab/samgraph/common/dist/dist_engine.cc:691] Trainer[0] pin memory queue...
[2023-08-04 19:42:12.156350: W /gnnlab/samgraph/common/dist/dist_engine.cc:691] Trainer[1] pin memory queue...
[2023-08-04 19:42:19.277449: E /gnnlab/samgraph/common/dist/dist_engine.cc:85] Running on V100
[2023-08-04 19:42:19.277819: W /gnnlab/samgraph/common/dist/dist_engine.cc:726] Trainer[2] register host memory...
[2023-08-04 19:42:19.277873: E /gnnlab/samgraph/common/dist/dist_engine.cc:85] Running on V100
[2023-08-04 19:42:19.278191: W /gnnlab/samgraph/common/dist/dist_engine.cc:726] Trainer[0] register host memory...
[2023-08-04 19:42:19.292413: E /gnnlab/samgraph/common/dist/dist_engine.cc:85] Running on V100
[2023-08-04 19:42:19.292494: W /gnnlab/samgraph/common/dist/dist_engine.cc:726] Trainer[1] register host memory...
[2023-08-04 19:42:19.530470: E /gnnlab/samgraph/common/dist/dist_engine.cc:85] Running on V100
[2023-08-04 19:42:19.534374: W /gnnlab/samgraph/common/cuda/cuda_device.cc:49] GPU[3] alloc cuda memory 423.66 MB
[2023-08-04 19:42:19.652360: W /gnnlab/samgraph/common/cuda/cuda_device.cc:49] GPU[3] alloc cuda memory 12.03 GB
[2023-08-04 19:42:22.648912: W /gnnlab/samgraph/common/cuda/cuda_device.cc:49] GPU[3] alloc cuda memory 256.00 MB
[2023-08-04 19:42:22.649185: W /gnnlab/samgraph/common/cuda/cuda_device.cc:49] GPU[3] alloc cuda memory 16.11 MB
[2023-08-04 19:42:22.649805: W /gnnlab/samgraph/common/cuda/cuda_device.cc:49] GPU[3] alloc cuda memory 12.08 MB
[2023-08-04 19:42:22.652903: E /gnnlab/samgraph/common/dist/pre_sampler.cc:41] Dist Presampler making shuffler...
[2023-08-04 19:42:22.656228: E /gnnlab/samgraph/common/dist/pre_sampler.cc:44] Dist Presampler making shuffler...Done
[2023-08-04 19:42:22.656275: W /gnnlab/samgraph/common/cpu/cpu_device.cc:39] WORKER[0] alloc host memory 847.32 MB
[2023-08-04 19:42:22.946658: E /gnnlab/samgraph/common/dist/pre_sampler.cc:85] Dist Presampler doing presample epoch 0
[2023-08-04 19:42:26.910657: E /gnnlab/samgraph/common/dist/pre_sampler.cc:129] presample spend 2.76918 on sample, 0.145764 on copy, 1.04222 on count
[2023-08-04 19:42:26.910788: E /gnnlab/samgraph/common/dist/pre_sampler.cc:85] Dist Presampler doing presample epoch 1
[2023-08-04 19:42:30.874989: E /gnnlab/samgraph/common/dist/pre_sampler.cc:129] presample spend 5.50206 on sample, 0.288633 on copy, 2.12529 on count
[2023-08-04 19:42:30.875100: E /gnnlab/samgraph/common/dist/pre_sampler.cc:136] max_num_inputs = 1553181, min_num_inputs = 1483471
[2023-08-04 19:42:31.137140: E /gnnlab/samgraph/common/dist/pre_sampler.cc:148] presample spend 0.261958 on sort freq.
[2023-08-04 19:42:31.444704: E /gnnlab/samgraph/common/dist/dist_engine.cc:549] pre sample done, delete it
[[2023-08-04 19:42:31[2023-08-04 19:42:31.2023-08-04 19:42:31.473119473128.: 473134: W: W W /gnnlab/samgraph/common/dist/dist_engine.cc/gnnlab/samgraph/common/dist/dist_engine.cc :/gnnlab/samgraph/common/dist/dist_engine.cc:736:736] 736] Trainer[2] building cache...] Trainer[0] building cache...
Trainer[1] building cache...

[2023-08-04 19:42:31.474035: E /ugache/coll_cache_lib/run_config.cc:158] using concurrent impl 9
[2023-08-04 19:42:31.474077: E /ugache/coll_cache_lib/facade.cc:309] before scale, dtype is 0, dim is 128
[2023-08-04 19:42:31.474105: E /ugache/coll_cache_lib/facade.cc:315] after scale, dtype is 7, new dim is 32
[2023-08-04 19:42:31.474385: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:297] assigning 0 to cpu
[2023-08-04 19:42:31.474445: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:314] build symm link desc with 3X Tesla V100-SXM2-16GB out of 4
[2023-08-04 19:42:31.474483: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:315] remote time is 9.21053
[2023-08-04 19:42:31.474512: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:316] cpu time is 31.8182
[2023-08-04 19:42:31.474556: E /ugache/coll_cache_lib/facade.cc:326] registering cpu data with 16.00 GB
[[2023-08-04 19:42:312023-08-04 19:42:31..474741474755: : EE  /ugache/coll_cache_lib/run_config.cc/ugache/coll_cache_lib/run_config.cc::158158] ] using concurrent impl 9using concurrent impl 9

[[2023-08-04 19:42:312023-08-04 19:42:31..474895474899: : EE  /ugache/coll_cache_lib/facade.cc/ugache/coll_cache_lib/facade.cc::309309] ] before scale, dtype is 0, dim is 128before scale, dtype is 0, dim is 128

[[2023-08-04 19:42:312023-08-04 19:42:31..475023475026: : EE  /ugache/coll_cache_lib/facade.cc/ugache/coll_cache_lib/facade.cc::315315] ] after scale, dtype is 7, new dim is 32after scale, dtype is 7, new dim is 32

[2023-08-04 19:42:31.476010: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2023-08-04 19:42:31297.] 476046assigning 0 to cpu: 
E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:297] assigning 0 to cpu
[2023-08-04 19:42:31.476129: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc[:2023-08-04 19:42:31314.] 476163build symm link desc with 3X Tesla V100-SXM2-16GB out of 4: 
E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:314] [build symm link desc with 3X Tesla V100-SXM2-16GB out of 42023-08-04 19:42:31
.476230: E [/ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc2023-08-04 19:42:31:.315476271] : remote time is 9.21053E
 /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:315[] 2023-08-04 19:42:31remote time is 9.21053.
476332: E [/ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc2023-08-04 19:42:31:.316476373] : cpu time is 31.8182E
 /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:316] cpu time is 31.8182
[2023-08-04 19:42:31.476461: E [/ugache/coll_cache_lib/facade.cc2023-08-04 19:42:31:.326476490] : registering cpu data with 16.00 GBE
 /ugache/coll_cache_lib/facade.cc:326] registering cpu data with 16.00 GB
[2023-08-04 19:42:34. 76228: E /ugache/coll_cache_lib/facade.cc:328] registering cpu data done.
[2023-08-04 19:42:34. 76359: E /ugache/coll_cache_lib/facade.cc:328] registering cpu data done.
[2023-08-04 19:42:34. 76435: E /ugache/coll_cache_lib/facade.cc:109] creating solver
[2023-08-04 19:42:34. 76470: E /ugache/coll_cache_lib/facade.cc:153] solver created. now build & solve
[2023-08-04 19:42:34. 95583: E /ugache/coll_cache_lib/facade.cc:328] registering cpu data done.
[2023-08-04 19:42:34.131817: E /ugache/coll_cache_lib/facade.cc:158] solver built. now solve
[2023-08-04 19:42:34.131867: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:1860] num_cached_nodes = 17769592
[2023-08-04 19:42:34.351384: E /ugache/coll_cache_lib/facade.cc:162] solver solved
[2023-08-04 19:42:34.351493: E /ugache/coll_cache_lib/facade.cc:338] 0 solved master
[2023-08-04 19:42:34.351541: E /ugache/coll_cache_lib/facade.cc:345] 0 solved
[2023-08-04 19:42:34.351575: E /ugache/coll_cache_lib/facade.cc:348] worker 0 thread 0 initing device 0
[2023-08-04 19:42:34.353428: E /ugache/coll_cache_lib/cache_context.cu:2388] Building Coll Cache with ... num gpu device is 3
[2023-08-04 19:42:34.353560: E /ugache/coll_cache_lib/cuda/cache_hashtable.cuh:652] per src size local is 19546651
[2023-08-04 19:42:34.381409: E /ugache/coll_cache_lib/facade.cc:345] 2 solved
[2023-08-04 19:42:34.381482: E /ugache/coll_cache_lib/facade.cc:348] worker 2 thread 2 initing device 2
[2023-08-04 19:42:34.382130: E /ugache/coll_cache_lib/facade.cc:345] 1 solved
[2023-08-04 19:42:34.382185: E /ugache/coll_cache_lib/facade.cc:348] worker 1 thread 1 initing device 1
[2023-08-04 19:42:34.415200: E /ugache/coll_cache_lib/cache_context.cu:2388] Building Coll Cache with ... num gpu device is 3
[2023-08-04 19:42:34.418633: E /ugache/coll_cache_lib/cache_context.cu:2388] Building Coll Cache with ... num gpu device is 3
[2023-08-04 19:42:34.461714: E /ugache/coll_cache_lib/common.cc:261] making a tensor with 0 num item
[2023-08-04 19:42:34.461844: E /ugache/coll_cache_lib/cache_context.cu:2430] num cpu nodes is 93290364
[2023-08-04 19:42:34.476509: E /ugache/coll_cache_lib/common.cc:261] making a tensor with 0 num item
[2023-08-04 19:42:34.476582: E /ugache/coll_cache_lib/cache_context.cu:2430] num cpu nodes is 93290364
[2023-08-04 19:42:34.478991: E /ugache/coll_cache_lib/common.cc:261] making a tensor with 0 num item
[2023-08-04 19:42:34.479076: E /ugache/coll_cache_lib/cache_context.cu:2430] num cpu nodes is 93290364
[2023-08-04 19:42:35.248387: E /ugache/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 17769592 possible elem, scale to 67108864
[2023-08-04 19:42:35.248482: E /ugache/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 512.00 MB
[2023-08-04 19:42:35.255885: E /ugache/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 17769592 possible elem, scale to 67108864
[2023-08-04 19:42:35.255942: E /ugache/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 512.00 MB
[2023-08-04 19:42:35.256138: E /ugache/coll_cache_lib/cuda/cache_hashtable.cu:355] create a hashtable with 17769592 possible elem, scale to 67108864
[2023-08-04 19:42:35.256193: E /ugache/coll_cache_lib/cuda/cache_hashtable.cu:360] SimpleHashTable allocating 512.00 MB
[2023-08-04 19:42:35.278934: E /ugache/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?17880652->111060
[2023-08-04 19:42:35.278997: E /ugache/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?17880652->111060
[2023-08-04 19:42:35.279099: E /ugache/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?17880652->111060
[2023-08-04 19:42:35.315778: E /ugache/coll_cache_lib/cache_context.cu:2528] Asymm Coll cache (policy: rep_cache) | local 17769592 / 111059956 nodes ( 16.00 %~16.00 %) | remote 0 / 111059956 nodes ( 0.00 %) | cpu 93290364 / 111059956 nodes ( 84.00 %) | 8.53 GB | 0.962291 secs 
[2023-08-04 19:42:35.318450: E /ugache/coll_cache_lib/cache_context.cu:2528] Asymm Coll cache (policy: rep_cache) | local 17769592 / 111059956 nodes ( 16.00 %~16.00 %) | remote 0 / 111059956 nodes ( 0.00 %) | cpu 93290364 / 111059956 nodes ( 84.00 %) | 8.53 GB | 0.903116 secs 
[2023-08-04 19:42:35.320263: E /ugache/coll_cache_lib/cache_context.cu:2528] Asymm Coll cache (policy: rep_cache) | local 17769592 / 111059956 nodes ( 16.00 %~16.00 %) | remote 0 / 111059956 nodes ( 0.00 %) | cpu 93290364 / 111059956 nodes ( 84.00 %) | 8.53 GB | 0.901578 secs 
[2023-08-04 19:42:35.321132: E /ugache/coll_cache_lib/run_config.cc:158] using concurrent impl 9
[2023-08-04 19:42:35.321185: E /ugache/coll_cache_lib/facade.cc:309] before scale, dtype is 6, dim is 1
[2023-08-04 19:42:35.321218: E /ugache/coll_cache_lib/facade.cc:315] after scale, dtype is 6, new dim is 1
[2023-08-04 19:42:35.321250: E /ugache/coll_cache_lib/run_config.cc:158] using concurrent impl 9
[2023-08-04 19:42:35.321301: E /ugache/coll_cache_lib/facade.cc:309] before scale, dtype is 6, dim is 1
[2023-08-04 19:42:35.321334: E /ugache/coll_cache_lib/facade.cc:315] after scale, dtype is 6, new dim is 1
[2023-08-04 19:42:35.321871: E /ugache/coll_cache_lib/run_config.cc:158] using concurrent impl 9
[2023-08-04 19:42:35.321923: E /ugache/coll_cache_lib/facade.cc:309] before scale, dtype is 6, dim is 1
[2023-08-04 19:42:35.321956: E /ugache/coll_cache_lib/facade.cc:315] after scale, dtype is 6, new dim is 1
[2023-08-04 19:42:35.326803: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:297] assigning 0 to cpu
[2023-08-04 19:42:35.326848: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:314] build symm link desc with 3X Tesla V100-SXM2-16GB out of 4
[2023-08-04 19:42:35.326888: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:315] remote time is 9.21053
[2023-08-04 19:42:35.326922: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:316] cpu time is 31.8182
[2023-08-04 19:42:35.326966: E /ugache/coll_cache_lib/facade.cc:326] registering cpu data with 848.00 MB
[2023-08-04 19:42:35.334587: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:297] assigning 0 to cpu
[2023-08-04 19:42:35.334634: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:314] build symm link desc with 3X Tesla V100-SXM2-16GB out of 4
[2023-08-04 19:42:35.334675: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:315] remote time is 9.21053
[2023-08-04 19:42:35.334709: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:316] cpu time is 31.8182
[2023-08-04 19:42:35.334764: E /ugache/coll_cache_lib/facade.cc:326] registering cpu data with 848.00 MB
[2023-08-04 19:42:35.335189: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:297] assigning 0 to cpu
[2023-08-04 19:42:35.335267: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:314] build symm link desc with 3X Tesla V100-SXM2-16GB out of 4
[2023-08-04 19:42:35.335309: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:315] remote time is 9.21053
[2023-08-04 19:42:35.335338: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:316] cpu time is 31.8182
[2023-08-04 19:42:35.335378: E /ugache/coll_cache_lib/facade.cc:326] registering cpu data with 848.00 MB
[2023-08-04 19:42:35.415069: E /ugache/coll_cache_lib/facade.cc:328] registering cpu data done.
[2023-08-04 19:42:35.415296: E /ugache/coll_cache_lib/facade.cc:328] registering cpu data done.
[2023-08-04 19:42:35.416209: E /ugache/coll_cache_lib/facade.cc:328] registering cpu data done.
[[[2023-08-04 19:42:352023-08-04 19:42:352023-08-04 19:42:35...416265416264416264: : : EEE   /ugache/coll_cache_lib/facade.cc/ugache/coll_cache_lib/facade.cc/ugache/coll_cache_lib/facade.cc:::345345345] ] ] 1 solved0 solved2 solved


[[2023-08-04 19:42:35[2023-08-04 19:42:35.2023-08-04 19:42:35.416345.416347: 416348: E: E E /ugache/coll_cache_lib/facade.cc /ugache/coll_cache_lib/facade.cc:/ugache/coll_cache_lib/facade.cc:348:348] 348] worker 1 thread 1 initing device 1] worker 0 thread 0 initing device 0
worker 2 thread 2 initing device 2

[2023-08-04 19:42:35.990945: W /gnnlab/samgraph/common/cuda/cuda_device.cc:49] GPU[3] alloc cuda memory 12.60 MB
[2023-08-04 19:42:36. 22197: W /gnnlab/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 10.56 MB
[2023-08-04 19:42:36. 22689: W /gnnlab/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 10.56 MB
[2023-08-04 19:42:36. 25947: W /gnnlab/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 801.61 MB
[2023-08-04 19:42:36. 26290: W /gnnlab/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 23.49 MB
[2023-08-04 19:42:36. 26616: W /gnnlab/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 23.49 MB
[2023-08-04 19:42:36. 38925: W /gnnlab/samgraph/common/cuda/cuda_device.cc:49] GPU[0] alloc cuda memory 801.61 MB
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
