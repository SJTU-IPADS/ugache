succeed=True
config:eval_tsp="2023-08-06 08:16:47"
config:num_worker=8
config:num_intra_size=8
config:root_dir=/datasets_gnn/wholegraph
config:graph_name=com-friendster
config:epochs=4
config:batchsize=8000
config:skip_epoch=2
config:local_step=125
config:presc_epoch=2
config:neighbors=15,10,5
config:hiddensize=256
config:num_layer=3
config:model=gcn
config:framework=dgl
config:dataloaderworkers=0
config:dropout=0.5
config:weight_decay=0.0005
config:lr=0.003
config:use_nccl=False
config:use_amp=False
config:use_collcache=False
config:cache_percentage=0.25
config:cache_policy=coll_cache_asymm_link
config:omp_thread_num=56
config:unsupervised=False
config:classnum=100
config:global_barrier=<multiprocessing.synchronize.Barrier object at 0x7ff2defc4940>
config:worker_id=0
creating_intra_node_communicator root=0, local_size=8, world_size=8
Rank=0, Graph loaded.
!!!!Train_dataloader(with 15 items) enumerate latency: 0.19109582901000977
torch.Size([8000]) torch.Size([8000])
torch.Size([8400]) torch.Size([8400])
!!!!Train_data_list(with 15 items) enumerate latency: 3.0994415283203125e-06, transfer latency: 0.1331615447998047
epoch=4 total_steps=60
start training...
[Epoch 0][Step 0], time=1.4032013416290283, ext_time=0.03679823875427246, train_time=1.3476665019989014
[Epoch 0][Step 1], time=0.06577658653259277, ext_time=0.012253284454345703, train_time=0.04204297065734863
[Epoch 0][Step 2], time=0.06536483764648438, ext_time=0.011780977249145508, train_time=0.04336404800415039
[Epoch 0][Step 3], time=0.06527304649353027, ext_time=0.01214742660522461, train_time=0.04273080825805664
[Epoch 0][Step 4], time=0.0608975887298584, ext_time=0.01216888427734375, train_time=0.03843545913696289
[Epoch 0][Step 5], time=0.061090946197509766, ext_time=0.012186288833618164, train_time=0.038611412048339844
[Epoch 0][Step 6], time=0.06149625778198242, ext_time=0.012096405029296875, train_time=0.03755545616149902
[Epoch 0][Step 7], time=0.059203147888183594, ext_time=0.01204538345336914, train_time=0.03685355186462402
[Epoch 0][Step 8], time=0.06464934349060059, ext_time=0.012097597122192383, train_time=0.04228067398071289
[Epoch 0][Step 9], time=0.06076550483703613, ext_time=0.012024402618408203, train_time=0.03849291801452637
[Epoch 0][Step 10], time=0.06193375587463379, ext_time=0.012165307998657227, train_time=0.03940916061401367
[Epoch 0][Step 11], time=0.06111550331115723, ext_time=0.01221013069152832, train_time=0.03854537010192871
[Epoch 0][Step 12], time=0.059073448181152344, ext_time=0.011988639831542969, train_time=0.0368654727935791
[Epoch 0][Step 13], time=0.06161236763000488, ext_time=0.012060403823852539, train_time=0.0391993522644043
[Epoch 0][Step 14], time=0.06403374671936035, ext_time=0.012070655822753906, train_time=0.04173994064331055
[Epoch 0], time=2.2764930725097656, loss=4.5220489501953125
[Epoch 1][Step 0], time=0.06460261344909668, ext_time=0.012758731842041016, train_time=0.04103231430053711
[Epoch 1][Step 1], time=0.05902218818664551, ext_time=0.012323379516601562, train_time=0.03627300262451172
[Epoch 1][Step 2], time=0.05951642990112305, ext_time=0.011911869049072266, train_time=0.03743696212768555
[Epoch 1][Step 3], time=0.05924868583679199, ext_time=0.012219667434692383, train_time=0.03663301467895508
[Epoch 1][Step 4], time=0.05897331237792969, ext_time=0.012138128280639648, train_time=0.036542415618896484
[Epoch 1][Step 5], time=0.05922865867614746, ext_time=0.012115001678466797, train_time=0.036818742752075195
[Epoch 1][Step 6], time=0.05883455276489258, ext_time=0.01207876205444336, train_time=0.036438703536987305
[Epoch 1][Step 7], time=0.0587925910949707, ext_time=0.012034893035888672, train_time=0.0364682674407959
[Epoch 1][Step 8], time=0.05956125259399414, ext_time=0.012097358703613281, train_time=0.037197113037109375
[Epoch 1][Step 9], time=0.059309959411621094, ext_time=0.012006521224975586, train_time=0.03702092170715332
[Epoch 1][Step 10], time=0.0592501163482666, ext_time=0.012190580368041992, train_time=0.03671526908874512
[Epoch 1][Step 11], time=0.05907416343688965, ext_time=0.012179851531982422, train_time=0.03653287887573242
[Epoch 1][Step 12], time=0.05923748016357422, ext_time=0.011997222900390625, train_time=0.037023305892944336
[Epoch 1][Step 13], time=0.05890631675720215, ext_time=0.012096881866455078, train_time=0.036513566970825195
[Epoch 1][Step 14], time=0.05900692939758301, ext_time=0.01201629638671875, train_time=0.036756277084350586
[Epoch 1], time=0.8935482501983643, loss=4.433116436004639
[Epoch 2][Step 0], time=0.06321930885314941, ext_time=0.016303300857543945, train_time=0.036150217056274414
[Epoch 2][Step 1], time=0.05897951126098633, ext_time=0.012310028076171875, train_time=0.036248207092285156
[Epoch 2][Step 2], time=0.05951356887817383, ext_time=0.011942863464355469, train_time=0.037427663803100586
[Epoch 2][Step 3], time=0.05894279479980469, ext_time=0.012238025665283203, train_time=0.03633570671081543
[Epoch 2][Step 4], time=0.05909156799316406, ext_time=0.01214289665222168, train_time=0.03662514686584473
[Epoch 2][Step 5], time=0.05936741828918457, ext_time=0.012111425399780273, train_time=0.03695249557495117
[Epoch 2][Step 6], time=0.0587773323059082, ext_time=0.012099742889404297, train_time=0.036371707916259766
[Epoch 2][Step 7], time=0.05871939659118652, ext_time=0.012046337127685547, train_time=0.03639554977416992
[Epoch 2][Step 8], time=0.05951714515686035, ext_time=0.012095212936401367, train_time=0.03714609146118164
[Epoch 2][Step 9], time=0.059247732162475586, ext_time=0.012010574340820312, train_time=0.03699827194213867
[Epoch 2][Step 10], time=0.059232234954833984, ext_time=0.012155771255493164, train_time=0.03671097755432129
[Epoch 2][Step 11], time=0.05935978889465332, ext_time=0.012188196182250977, train_time=0.036803245544433594
[Epoch 2][Step 12], time=0.05929875373840332, ext_time=0.012009143829345703, train_time=0.03705883026123047
[Epoch 2][Step 13], time=0.0588994026184082, ext_time=0.012065410614013672, train_time=0.036527156829833984
[Epoch 2][Step 14], time=0.05903029441833496, ext_time=0.012030363082885742, train_time=0.03675198554992676
[Epoch 2], time=0.8921568393707275, loss=4.344359874725342
[Epoch 3][Step 0], time=0.06635379791259766, ext_time=0.012639760971069336, train_time=0.04292154312133789
[Epoch 3][Step 1], time=0.0594637393951416, ext_time=0.012282371520996094, train_time=0.03674745559692383
[Epoch 3][Step 2], time=0.059484004974365234, ext_time=0.011927604675292969, train_time=0.03739786148071289
[Epoch 3][Step 3], time=0.059084177017211914, ext_time=0.012226104736328125, train_time=0.036495208740234375
[Epoch 3][Step 4], time=0.05900883674621582, ext_time=0.012128829956054688, train_time=0.03657341003417969
[Epoch 3][Step 5], time=0.059273481369018555, ext_time=0.012124300003051758, train_time=0.0368499755859375
[Epoch 3][Step 6], time=0.0588231086730957, ext_time=0.012094736099243164, train_time=0.03635764122009277
[Epoch 3][Step 7], time=0.05878090858459473, ext_time=0.012019634246826172, train_time=0.036492347717285156
[Epoch 3][Step 8], time=0.05924534797668457, ext_time=0.01208186149597168, train_time=0.03687477111816406
[Epoch 3][Step 9], time=0.05932354927062988, ext_time=0.011988162994384766, train_time=0.03710579872131348
[Epoch 3][Step 10], time=0.059261322021484375, ext_time=0.012145757675170898, train_time=0.036733150482177734
[Epoch 3][Step 11], time=0.05957674980163574, ext_time=0.012193679809570312, train_time=0.037015438079833984
[Epoch 3][Step 12], time=0.05912041664123535, ext_time=0.012032270431518555, train_time=0.03686928749084473
[Epoch 3][Step 13], time=0.05887484550476074, ext_time=0.012101173400878906, train_time=0.036457061767578125
[Epoch 3][Step 14], time=0.05911993980407715, ext_time=0.011956214904785156, train_time=0.03693556785583496
[Epoch 3], time=0.895744800567627, loss=4.255802631378174
    [Step(average) Profiler Level 1 E3 S119]
        L1  sample           0.010419 | send           0.000000
        L1  recv             0.000000 | copy           0.019840 | convert time 0.000000 | train  0.029273
        L1  feature nbytes 0.00 Bytes | label nbytes 0.00 Bytes
        L1  id nbytes      0.00 Bytes | graph nbytes 0.00 Bytes
        L1  miss nbytes    0.00 Bytes | remote nbytes 0.00 Bytes
        L1  num nodes               0 | num samples           0
        L1  seq duration     0.000000 | refresh duration   0.000000
    [Step(average) Profiler Level 2 E3 S119]
        L2  shuffle     0.000000 | core sample  0.000000 | id remap        0.000000
        L2  graph copy  0.000000 | id copy      0.000000 | cache feat copy 0.019840
        L2  last layer sample time 0.000000 | size 0.000000
    [Step(average) Profiler Level 3 E3 S119]
        L3  khop sample coo  0.000000 | khop sort coo      0.000000 | khop count edge     0.000000 | khop compact edge 0.000000
        L3  walk sample coo  0.000000 | walk topk total    0.000000 | walk topk step1     0.000000 | walk topk step2   0.000000
        L3  walk topk step3  0.000000 | walk topk step4    0.000000 | walk topk step5     0.000000
        L3  walk topk step6  0.000000 | walk topk step7    0.000000
        L3  remap unique     0.000000 | remap populate     0.000000 | remap mapnode       0.000000 | remap mapedge     0.000000
        L3  cache get_index  0.000000 | cache copy_index   0.000000 | cache extract_miss  0.000000
        L3  cache copy_miss  0.000000 | cache combine_miss 0.000000 | cache combine cache 0.000000 | cache combine remote 0.000000
        L3  label extract  0.000000
    [Profiler Level Percentiles E3 S119]
        p50.00_tail_logl2featcopy=0.020824
        p90.00_tail_logl2featcopy=0.021228
        p95.00_tail_logl2featcopy=0.021507
        p99.00_tail_logl2featcopy=0.044198
        p99.90_tail_logl2featcopy=0.045400
[CUDA] cuda: usage: 41.60 GB
Rank=7, Graph loaded.
!!!!Train_dataloader(with 15 items) enumerate latency: 0.1920337677001953
torch.Size([8000]) torch.Size([8000])
torch.Size([8400]) torch.Size([8400])
!!!!Train_data_list(with 15 items) enumerate latency: 4.0531158447265625e-06, transfer latency: 0.13653302192687988
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3529 MB |    9421 MB |    1022 GB |    1018 GB |
|       from large pool |    3523 MB |    9415 MB |    1020 GB |    1017 GB |
|       from small pool |       6 MB |      11 MB |       1 GB |       1 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3529 MB |    9421 MB |    1022 GB |    1018 GB |
|       from large pool |    3523 MB |    9415 MB |    1020 GB |    1017 GB |
|       from small pool |       6 MB |      11 MB |       1 GB |       1 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   27498 MB |   27498 MB |   27498 MB |       0 B  |
|       from large pool |   27484 MB |   27484 MB |   27484 MB |       0 B  |
|       from small pool |      14 MB |      14 MB |      14 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     778 MB |   10382 MB |  631973 MB |  631194 MB |
|       from large pool |     774 MB |   10376 MB |  630621 MB |  629846 MB |
|       from small pool |       3 MB |       6 MB |    1352 MB |    1348 MB |
|---------------------------------------------------------------------------|
| Allocations           |      63    |      89    |   14316    |   14253    |
|       from large pool |      22    |      42    |    7296    |    7274    |
|       from small pool |      41    |      49    |    7020    |    6979    |
|---------------------------------------------------------------------------|
| Active allocs         |      63    |      89    |   14316    |   14253    |
|       from large pool |      22    |      42    |    7296    |    7274    |
|       from small pool |      41    |      49    |    7020    |    6979    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      31    |      31    |       0    |
|       from large pool |      24    |      24    |      24    |       0    |
|       from small pool |       7    |       7    |       7    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |      46    |    5939    |    5906    |
|       from large pool |      16    |      26    |    4220    |    4204    |
|       from small pool |      17    |      24    |    1719    |    1702    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[TRAIN_TIME] train time is 4.958491 seconds
[EPOCH_TIME] 1.239623 seconds, maybe large due to not enough epoch skipped.
[EPOCH_TIME] 0.894062 seconds
Rank=3, Graph loaded.
!!!!Train_dataloader(with 15 items) enumerate latency: 0.19298982620239258
torch.Size([8000]) torch.Size([8000])
torch.Size([8400]) torch.Size([8400])
!!!!Train_data_list(with 15 items) enumerate latency: 3.337860107421875e-06, transfer latency: 0.136199951171875
Rank=5, Graph loaded.
!!!!Train_dataloader(with 15 items) enumerate latency: 0.19382476806640625
torch.Size([8000]) torch.Size([8000])
torch.Size([8400]) torch.Size([8400])
!!!!Train_data_list(with 15 items) enumerate latency: 3.337860107421875e-06, transfer latency: 0.13903307914733887
Rank=1, Graph loaded.
!!!!Train_dataloader(with 15 items) enumerate latency: 0.19051718711853027
torch.Size([8000]) torch.Size([8000])
torch.Size([8400]) torch.Size([8400])
!!!!Train_data_list(with 15 items) enumerate latency: 3.337860107421875e-06, transfer latency: 0.13387489318847656
Rank=2, Graph loaded.
!!!!Train_dataloader(with 15 items) enumerate latency: 0.19525933265686035
torch.Size([8000]) torch.Size([8000])
torch.Size([8400]) torch.Size([8400])
!!!!Train_data_list(with 15 items) enumerate latency: 4.0531158447265625e-06, transfer latency: 0.13659095764160156
Rank=6, Graph loaded.
!!!!Train_dataloader(with 15 items) enumerate latency: 0.18908429145812988
torch.Size([8000]) torch.Size([8000])
torch.Size([8400]) torch.Size([8400])
!!!!Train_data_list(with 15 items) enumerate latency: 3.5762786865234375e-06, transfer latency: 0.13358306884765625
Rank=4, Graph loaded.
!!!!Train_dataloader(with 15 items) enumerate latency: 0.196502685546875
torch.Size([8000]) torch.Size([8000])
torch.Size([8400]) torch.Size([8400])
!!!!Train_data_list(with 15 items) enumerate latency: 2.86102294921875e-06, transfer latency: 0.14010143280029297

