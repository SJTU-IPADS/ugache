/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.12) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
Rank=1 done reading 61040125 embedding vectors from file /datasets_gnn/wholegraph/mag240m_homo/converted/homograph_csr_row_ptr
Rank=3 done reading 61040125 embedding vectors from file /datasets_gnn/wholegraph/mag240m_homo/converted/homograph_csr_row_ptr
Rank=0 done reading 61040125 embedding vectors from file /datasets_gnn/wholegraph/mag240m_homo/converted/homograph_csr_row_ptr
Rank=2 done reading 61040125 embedding vectors from file /datasets_gnn/wholegraph/mag240m_homo/converted/homograph_csr_row_ptr
Rank=1 done reading 863617956 embedding vectors from file /datasets_gnn/wholegraph/mag240m_homo/converted/homograph_csr_col_idx
Rank=3 done reading 863617956 embedding vectors from file /datasets_gnn/wholegraph/mag240m_homo/converted/homograph_csr_col_idx
Rank=0 done reading 863617956 embedding vectors from file /datasets_gnn/wholegraph/mag240m_homo/converted/homograph_csr_col_idx
Rank=2 done reading 863617956 embedding vectors from file /datasets_gnn/wholegraph/mag240m_homo/converted/homograph_csr_col_idx
[2023-08-06 08:49:23. 90135: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2752118 into 0
[2023-08-06 08:49:23.103436: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24333906
[2023-08-06 08:49:23.104050: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2749483 into 2752118
[2023-08-06 08:49:23.117420: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24325451
[2023-08-06 08:49:23.118037: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2750097 into 5501601
[2023-08-06 08:49:23.131417: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24326373
[2023-08-06 08:49:23.132034: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2749989 into 8251698
[2023-08-06 08:49:23.145253: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24342640
[2023-08-06 08:49:23.145868: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2748724 into 11001687
[2023-08-06 08:49:23.159156: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24396681
[2023-08-06 08:49:23.159773: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2749406 into 13750411
[2023-08-06 08:49:23.173003: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24360900
[2023-08-06 08:49:23.173618: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2747544 into 16499817
[2023-08-06 08:49:23.186838: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24262554
[2023-08-06 08:49:23.187451: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2749462 into 19247361
[2023-08-06 08:49:23.200673: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24393918
[2023-08-06 08:49:23.201290: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2750026 into 21996823
[2023-08-06 08:49:23.214521: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24356312
[2023-08-06 08:49:23.215130: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2750599 into 24746849
[2023-08-06 08:49:23.228346: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24375454
[2023-08-06 08:49:23.229000: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2757189 into 27497448
[2023-08-06 08:49:23.242331: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24344141
[2023-08-06 08:49:23.242959: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2754044 into 30254637
[2023-08-06 08:49:23.256230: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24326211
[2023-08-06 08:49:23.256844: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2753539 into 33008681
[2023-08-06 08:49:23.270102: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24312108
[2023-08-06 08:49:23.270728: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2754952 into 35762220
[2023-08-06 08:49:23.284014: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24357612
[2023-08-06 08:49:23.284653: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2753733 into 38517172
[2023-08-06 08:49:23.297908: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24404141
[2023-08-06 08:49:23.298530: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2752015 into 41270905
[2023-08-06 08:49:23.311782: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24354488
[2023-08-06 08:49:23.312397: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2750763 into 44022920
[2023-08-06 08:49:23.325642: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24269022
[2023-08-06 08:49:23.326260: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2752506 into 46773683
[2023-08-06 08:49:23.339514: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24399697
[2023-08-06 08:49:23.340128: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2754499 into 49526189
[2023-08-06 08:49:23.353392: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24358370
[2023-08-06 08:49:23.354015: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2755392 into 52280688
[2023-08-06 08:49:23.367293: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24379296
[2023-08-06 08:49:23.367919: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2752953 into 55036080
[2023-08-06 08:49:23.381212: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24326745
[2023-08-06 08:49:23.381813: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2749055 into 57789033
[2023-08-06 08:49:23.395058: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24316321
[2023-08-06 08:49:23.395650: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2750805 into 60538088
[2023-08-06 08:49:23.408898: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24321726
[2023-08-06 08:49:23.409500: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2751231 into 63288893
[2023-08-06 08:49:23.422873: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24346086
[2023-08-06 08:49:23.423868: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2749292 into 66040124
[2023-08-06 08:49:23.437104: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24394387
[2023-08-06 08:49:23.437706: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2748947 into 68789416
[2023-08-06 08:49:23.450945: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24347152
[2023-08-06 08:49:23.451547: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2747081 into 71538363
[2023-08-06 08:49:23.464756: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24254686
[2023-08-06 08:49:23.465357: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2747761 into 74285444
[2023-08-06 08:49:23.478588: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24387908
[2023-08-06 08:49:23.479191: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2748767 into 77033205
[2023-08-06 08:49:23.492420: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24355736
[2023-08-06 08:49:23.493024: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2753576 into 79781972
[2023-08-06 08:49:23.506273: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24373682
[2023-08-06 08:49:23.506904: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2758091 into 82535548
[2023-08-06 08:49:23.520283: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24342473
[2023-08-06 08:49:23.520880: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2755700 into 85293639
[2023-08-06 08:49:23.534143: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24335219
[2023-08-06 08:49:23.534747: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2755877 into 88049339
[2023-08-06 08:49:23.547977: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24332498
[2023-08-06 08:49:23.548575: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2754971 into 90805216
[2023-08-06 08:49:23.561795: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24355478
[2023-08-06 08:49:23.562417: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2755237 into 93560187
[2023-08-06 08:49:23.575647: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24397210
[2023-08-06 08:49:23.576249: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2753910 into 96315424
[2023-08-06 08:49:23.589490: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24361408
[2023-08-06 08:49:23.590094: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2752916 into 99069334
[2023-08-06 08:49:23.603328: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24276614
[2023-08-06 08:49:23.603934: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2753451 into 101822250
[2023-08-06 08:49:23.617163: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24399407
[2023-08-06 08:49:23.617772: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2755972 into 104575701
[2023-08-06 08:49:23.631017: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24363486
[2023-08-06 08:49:23.631623: E /ugache/coll_cache_lib/freq_recorder.cc:337] bulk append 2756861 into 107331673
[2023-08-06 08:49:23.644873: E /ugache/coll_cache_lib/freq_recorder.cc:347] bulk append 24383308
[2023-08-06 08:49:23.645489: E /ugache/coll_cache_lib/freq_recorder.cc:266] [freq recorder global combining[[2023-08-06 08:49:23
2023-08-06 08:49:232023-08-06 08:49:23...645520645524645523: : : EEE   /ugache/coll_cache_lib/run_config.cc/ugache/coll_cache_lib/run_config.cc/ugache/coll_cache_lib/run_config.cc:::160160160] ] ] using concurrent impl 11using concurrent impl 11using concurrent impl 11


[2023-08-06 08:49:23.[[6456732023-08-06 08:49:232023-08-06 08:49:23: ..E645679645679 : : /ugache/coll_cache_lib/facade.ccEE:  422/ugache/coll_cache_lib/facade.cc/ugache/coll_cache_lib/facade.cc] ::before scale, dtype is 0, dim is 384422422
] ] before scale, dtype is 0, dim is 384[before scale, dtype is 0, dim is 384
2023-08-06 08:49:23
.[645790[2023-08-06 08:49:23: 2023-08-06 08:49:23.E.645806 645815: /ugache/coll_cache_lib/facade.cc: E:E 428 /ugache/coll_cache_lib/facade.cc] /ugache/coll_cache_lib/facade.cc:after scale, dtype is 7, new dim is 96:428
428] ] after scale, dtype is 7, new dim is 96after scale, dtype is 7, new dim is 96

[2023-08-06 08:49:23.646824: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:297] assigning 8 to cpu
[2023-08-06 08:49:23.646854: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:[2972023-08-06 08:49:23[] .2023-08-06 08:49:23assigning 8 to cpu646871.
: 646872E:  E/ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc [:/ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc2023-08-06 08:49:23297:.] 314646929assigning 8 to cpu] : 
build symm link desc with 4X Tesla V100-SXM2-16GB out of 4E
 /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:314] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2023-08-06 08:49:23.647013: [E2023-08-06 08:49:23 .[/ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc6470232023-08-06 08:49:23:: .314E647037]  : build symm link desc with 4X Tesla V100-SXM2-16GB out of 4/ugache/coll_cache_lib/coll_cache/asymm_link_desc.ccE
: 315/ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc] :[remote time is 9.210533152023-08-06 08:49:23
] .remote time is 9.21053647121
[: 2023-08-06 08:49:23[E.2023-08-06 08:49:23 647147./ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc: 647159:E: 315 E] /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc remote time is 9.21053:/ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc
316:] [316cpu time is 31.81822023-08-06 08:49:23] 
.cpu time is 31.8182647248
: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:316[] 2023-08-06 08:49:23[cpu time is 31.8182.2023-08-06 08:49:23
647291.: 647299E:  [E/ugache/coll_cache_lib/facade.cc2023-08-06 08:49:23 :./ugache/coll_cache_lib/facade.cc439647339:] : 439registering cpu data with 24.00 GBE] 
 registering cpu data with 24.00 GB/ugache/coll_cache_lib/facade.cc
:439] registering cpu data with 24.00 GB
[2023-08-06 08:49:27.[ 671442023-08-06 08:49:27: .E 67154 : /ugache/coll_cache_lib/facade.ccE: 441/ugache/coll_cache_lib/facade.cc] :registering cpu data done.441
] registering cpu data done.
[2023-08-06 08:49:27. 86537: E /ugache/coll_cache_lib/facade.cc:441] registering cpu data done.
[2023-08-06 08:49:29.211420: E /ugache/coll_cache_lib/freq_recorder.cc:269] freq recorder global combine from 110088534 to 46999948
[2023-08-06 08:49:30. 63273: E /ugache/coll_cache_lib/freq_recorder.cc:286] top 5 freq is 2224,2224,2224,2224,2224
[2023-08-06 08:49:30. 63405: E /ugache/coll_cache_lib/run_config.cc:160] using concurrent impl 11
[2023-08-06 08:49:30. 63451: E /ugache/coll_cache_lib/facade.cc:422] before scale, dtype is 0, dim is 384
[2023-08-06 08:49:30. 63485: E /ugache/coll_cache_lib/facade.cc:428] after scale, dtype is 7, new dim is 96
[2023-08-06 08:49:30. 63840: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:297] assigning 8 to cpu
[2023-08-06 08:49:30. 63887: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:314] build symm link desc with 4X Tesla V100-SXM2-16GB out of 4
[2023-08-06 08:49:30. 63947: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:315] remote time is 9.21053
[2023-08-06 08:49:30. 63982: E /ugache/coll_cache_lib/coll_cache/asymm_link_desc.cc:316] cpu time is 31.8182
[2023-08-06 08:49:30. 64038: E /ugache/coll_cache_lib/facade.cc:439] registering cpu data with 24.00 GB
[2023-08-06 08:49:31.657640: E /ugache/coll_cache_lib/facade.cc:441] registering cpu data done.
[2023-08-06 08:49:31.657726: E /ugache/coll_cache_lib/facade.cc:178] creating solver
[2023-08-06 08:49:31.657757: E /ugache/coll_cache_lib/facade.cc:222] solver created. now build & solve
[2023-08-06 08:49:31.783192: W /ugache/coll_cache_lib/cpu/cpu_device.cc:43] WORKER[0] alloc host memory 931.40 MB
[2023-08-06 08:49:31.783271: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:309] reconfigured max freq to be 2224
[2023-08-06 08:49:31.783308: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:311] reconfigured num slot to be 43
[2023-08-06 08:49:31.783334: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:318] counting slots...
[2023-08-06 08:49:32.989346: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:367] Final num slot is 57
[2023-08-06 08:49:32.989453: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:371] preparing block granularity...
[2023-08-06 08:49:32.989490: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 0 has 4089 nodes, max_size set to 1023, #slice=4
[2023-08-06 08:49:32.989522: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 1 has 5214 nodes, max_size set to 1304, #slice=4
[2023-08-06 08:49:32.989555: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 2 has 8266 nodes, max_size set to 2067, #slice=4
[2023-08-06 08:49:32.989587: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 3 has 12799 nodes, max_size set to 3200, #slice=4
[2023-08-06 08:49:32.989620: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 4 has 20015 nodes, max_size set to 5004, #slice=4
[2023-08-06 08:49:32.989652: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 5 has 30120 nodes, max_size set to 7530, #slice=4
[2023-08-06 08:49:32.989684: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 6 has 45111 nodes, max_size set to 11278, #slice=4
[2023-08-06 08:49:32.989717: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 7 has 65003 nodes, max_size set to 16251, #slice=4
[2023-08-06 08:49:32.989749: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 8 has 90847 nodes, max_size set to 22712, #slice=4
[2023-08-06 08:49:32.989780: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 9 has 122003 nodes, max_size set to 30501, #slice=4
[2023-08-06 08:49:32.989812: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 10 has 152940 nodes, max_size set to 38235, #slice=4
[2023-08-06 08:49:32.989844: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 11 has 186749 nodes, max_size set to 46688, #slice=4
[2023-08-06 08:49:32.989894: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 12 has 221592 nodes, max_size set to 55398, #slice=4
[2023-08-06 08:49:32.989926: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 13 has 250820 nodes, max_size set to 62705, #slice=4
[2023-08-06 08:49:32.989958: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 14 has 293135 nodes, max_size set to 73284, #slice=4
[2023-08-06 08:49:32.989990: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 15 has 331283 nodes, max_size set to 82821, #slice=4
[2023-08-06 08:49:32.990022: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 16 has 370634 nodes, max_size set to 92659, #slice=4
[2023-08-06 08:49:32.990054: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 17 has 420891 nodes, max_size set to 105223, #slice=4
[2023-08-06 08:49:32.990086: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 18 has 462977 nodes, max_size set to 115745, #slice=4
[2023-08-06 08:49:32.990119: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 19 has 477779 nodes, max_size set to 119445, #slice=4
[2023-08-06 08:49:32.990151: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 20 has 570064 nodes, max_size set to 142516, #slice=4
[2023-08-06 08:49:32.990183: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 21 has 604223 nodes, max_size set to 151056, #slice=4
[2023-08-06 08:49:32.990215: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 22 has 701466 nodes, max_size set to 175367, #slice=4
[2023-08-06 08:49:32.990247: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 23 has 805020 nodes, max_size set to 201255, #slice=4
[2023-08-06 08:49:32.990279: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 24 has 704364 nodes, max_size set to 176091, #slice=4
[2023-08-06 08:49:32.990311: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 25 has 910774 nodes, max_size set to 227694, #slice=4
[2023-08-06 08:49:32.990343: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 26 has 884532 nodes, max_size set to 221133, #slice=4
[2023-08-06 08:49:32.990375: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 27 has 1161454 nodes, max_size set to 244160, #slice=8
[2023-08-06 08:49:32.990419: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 28 has 1001679 nodes, max_size set to 1001679, #slice=1
[2023-08-06 08:49:32.990452: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 29 has 1288168 nodes, max_size set to 1288168, #slice=1
[2023-08-06 08:49:32.990484: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 30 has 1739469 nodes, max_size set to 1739469, #slice=1
[2023-08-06 08:49:32.990516: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 31 has 1133569 nodes, max_size set to 1133569, #slice=1
[2023-08-06 08:49:32.990548: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 32 has 1405883 nodes, max_size set to 1405883, #slice=1
[2023-08-06 08:49:32.990580: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 33 has 1805883 nodes, max_size set to 1805883, #slice=1
[2023-08-06 08:49:32.990612: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 34 has 2476104 nodes, max_size set to 2476104, #slice=1
[2023-08-06 08:49:32.990644: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 36 has 3676428 nodes, max_size set to 3676428, #slice=1
[2023-08-06 08:49:32.990676: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 38 has 6635617 nodes, max_size set to 6635617, #slice=1
[2023-08-06 08:49:32.990708: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 41 has 15922984 nodes, max_size set to 15922984, #slice=1
[2023-08-06 08:49:32.990745: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 42 has 1973240 nodes, max_size set to 1973240, #slice=1
[2023-08-06 08:49:32.990777: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 43 has 1970460 nodes, max_size set to 1970460, #slice=1
[2023-08-06 08:49:32.990809: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 44 has 1971761 nodes, max_size set to 1971761, #slice=1
[2023-08-06 08:49:32.990841: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 45 has 1971367 nodes, max_size set to 1971367, #slice=1
[2023-08-06 08:49:32.990873: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 46 has 1970422 nodes, max_size set to 1970422, #slice=1
[2023-08-06 08:49:32.990905: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 47 has 1972099 nodes, max_size set to 1972099, #slice=1
[2023-08-06 08:49:32.990937: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 48 has 1973648 nodes, max_size set to 1973648, #slice=1
[2023-08-06 08:49:32.990969: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 49 has 1967841 nodes, max_size set to 1967841, #slice=1
[2023-08-06 08:49:32.991001: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 50 has 1971926 nodes, max_size set to 1971926, #slice=1
[2023-08-06 08:49:32.991033: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 51 has 1973550 nodes, max_size set to 1973550, #slice=1
[2023-08-06 08:49:32.991065: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 52 has 19723758 nodes, max_size set to 19723758, #slice=1
[2023-08-06 08:49:32.991097: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 53 has 19710406 nodes, max_size set to 19710406, #slice=1
[2023-08-06 08:49:32.991129: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 54 has 19717356 nodes, max_size set to 19717356, #slice=1
[2023-08-06 08:49:32.991161: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 55 has 19713305 nodes, max_size set to 19713305, #slice=1
[2023-08-06 08:49:32.991193: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 56 has 19717874 nodes, max_size set to 19717874, #slice=1
[2023-08-06 08:49:32.991226: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 57 has 19714995 nodes, max_size set to 19714995, #slice=1
[2023-08-06 08:49:32.991258: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 58 has 19718125 nodes, max_size set to 19718125, #slice=1
[2023-08-06 08:49:32.991289: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 59 has 19713064 nodes, max_size set to 19713064, #slice=1
[2023-08-06 08:49:32.991321: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:399] slot 60 has 19715354 nodes, max_size set to 19715354, #slice=1
[2023-08-06 08:49:32.991353: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:405] counting blocks...
[2023-08-06 08:49:33.361120: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:425] Final num block is 145
[2023-08-06 08:49:33.361204: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:430] counting freq and density...
[2023-08-06 08:49:33.389135: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:479] averaging freq and density...
[2023-08-06 08:49:33.389228: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:480] 145
[2023-08-06 08:49:33.392317: E /ugache/coll_cache_lib/facade.cc:226] solver built. now solve
[2023-08-06 08:49:33.392375: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:893] constructing optimal solver, device=4, stream=1
145 blocks, 4 devices
[2023-08-06 08:49:34.462690: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:1080] Add Var...
[2023-08-06 08:49:34.468197: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:1098] Capacity...
[2023-08-06 08:49:34.468578: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:1101] Connect CPU...
[2023-08-06 08:49:34.472443: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:1103] Connect Access To Storage...
[2023-08-06 08:49:34.487223: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:1107] Time...
[2023-08-06 08:49:34.487514: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:1069] dst 0, total sm is 80
[2023-08-06 08:49:34.487903: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:1069] dst 1, total sm is 80
[2023-08-06 08:49:34.488240: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:1069] dst 2, total sm is 80
[2023-08-06 08:49:34.488574: E /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:1069] dst 3, total sm is 80
[2023-08-06 08:49:34.638078: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:1132] Coll Cache init block placement array
[2023-08-06 08:49:34.638710: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:1208] Coll Cache init block placement array done
[2023-08-06 08:49:34.638791: W /ugache/coll_cache_lib/coll_cache/optimal_solver_class.cc:1210] Coll Cache model reset done
[2023-08-06 08:49:34.641386: E /ugache/coll_cache_lib/facade.cc:230] solver solved
[2023-08-06 08:49:34.641433: E /ugache/coll_cache_lib/facade.cc:451] 0 solved master
[2023-08-06 08:49:34.641463: E /ugache/coll_cache_lib/facade.cc:458] 0 solved
[2023-08-06 08:49:34.641490: E /ugache/coll_cache_lib/facade.cc:461] worker 0 thread 0 initing device 0
[2023-08-06 08:49:34.642249: E /ugache/coll_cache_lib/cache_context.cu:2388] Building Coll Cache with ... num gpu device is 4
[2023-08-06 08:49:34.642908: E /ugache/coll_cache_lib/cuda/cache_hashtable.cuh:764] per src size local is 2685852
[2023-08-06 08:49:34.707587: E /ugache/coll_cache_lib/facade.cc:458] 3 solved
[2023-08-06 08:49:34.707660: E /ugache/coll_cache_lib/facade.cc:461] worker 0 thread 3 initing device 3
[2023-08-06 08:49:34.708245: E /ugache/coll_cache_lib/cache_context.cu:2388] Building Coll Cache with ... num gpu device is 4
[2023-08-06 08:49:34.719193: E /ugache/coll_cache_lib/facade.cc:458] 2 solved
[2023-08-06 08:49:34.719292: E /ugache/coll_cache_lib/facade.cc:461] worker 0 thread 2 initing device 2
[2023-08-06 08:49:34.719446: E /ugache/coll_cache_lib/facade.cc:458] 1 solved
[2023-08-06 08:49:34.719533: E /ugache/coll_cache_lib/facade.cc:461] worker 0 thread 1 initing device 1
[2023-08-06 08:49:34.720173: E /ugache/coll_cache_lib/cache_context.cu:2388] Building Coll Cache with ... num gpu device is 4
[2023-08-06 08:49:34.720695: E /ugache/coll_cache_lib/cache_context.cu:2388] Building Coll Cache with ... num gpu device is 4
[2023-08-06 08:49:34.723856: E /ugache/coll_cache_lib/cache_context.cu:2431] num cpu nodes is 234537511
[2023-08-06 08:49:34.819543: E /ugache/coll_cache_lib/cache_context.cu:2431] num cpu nodes is 234537511
[2023-08-06 08:49:34.823550: E /ugache/coll_cache_lib/cache_context.cu:2431] num cpu nodes is 234537511
[2023-08-06 08:49:34.826368: E /ugache/coll_cache_lib/cache_context.cu:2431] num cpu nodes is 234537511
[2023-08-06 08:49:35. 36284: E /ugache/coll_cache_lib/cache_context.cu:2458] simple hashtable small enough, use simple hashtable
[2023-08-06 08:49:35. 36341: E /ugache/coll_cache_lib/cuda/cache_hashtable.cu:443] create a hashtable with 9622988 possible elem, scale to 33554432
[2023-08-06 08:49:35. 36379: E /ugache/coll_cache_lib/cuda/cache_hashtable.cu:448] SimpleHashTable allocating 256.00 MB
[2023-08-06 08:49:35.123975: E /ugache/coll_cache_lib/cache_context.cu:2458] simple hashtable small enough, use simple hashtable
[2023-08-06 08:49:35.124039: E /ugache/coll_cache_lib/cuda/cache_hashtable.cu:443] create a hashtable with 9622988 possible elem, scale to 33554432
[2023-08-06 08:49:35.124076: E /ugache/coll_cache_lib/cuda/cache_hashtable.cu:448] SimpleHashTable allocating 256.00 MB
[2023-08-06 08:49:35.137789: E /ugache/coll_cache_lib/cache_context.cu:2458] simple hashtable small enough, use simple hashtable
[2023-08-06 08:49:35.137839: E /ugache/coll_cache_lib/cuda/cache_hashtable.cu:443] create a hashtable with 9622988 possible elem, scale to 33554432
[2023-08-06 08:49:35.137884: E /ugache/coll_cache_lib/cuda/cache_hashtable.cu:448] SimpleHashTable allocating 256.00 MB
[2023-08-06 08:49:35.138497: E /ugache/coll_cache_lib/cache_context.cu:2458] simple hashtable small enough, use simple hashtable
[2023-08-06 08:49:35.138545: E /ugache/coll_cache_lib/cuda/cache_hashtable.cu:443] create a hashtable with 9622988 possible elem, scale to 33554432
[2023-08-06 08:49:35.138579: E /ugache/coll_cache_lib/cuda/cache_hashtable.cu:448] SimpleHashTable allocating 256.00 MB
[2023-08-06 08:49:35.152375: E /ugache/coll_cache_lib/cache_context.cu:2522] 24416097,262144|24416105,262145|24416166,262146|24416180,262147|24416306,262148|
[2023-08-06 08:49:35.167459: E /ugache/coll_cache_lib/cache_context.cu:2522] 24416087,524288|24416101,524289|24416103,524290|24416199,524291|24416271,524292|
[2023-08-06 08:49:35.180878: E /ugache/coll_cache_lib/cache_context.cu:2522] 24416090,393216|24416110,393217|24416282,393218|24416321,393219|24416359,393220|
[2023-08-06 08:49:35.182870: E /ugache/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?2685765->257694
[2023-08-06 08:49:35.184555: E /ugache/coll_cache_lib/cache_context.cu:2554] Asymm Coll cache (policy: coll_cache_asymm_link) | local 2428071 / 244160499 nodes ( 0.99 %~1.00 %) | remote 7194917 / 244160499 nodes ( 2.95 %) | cpu 234537511 / 244160499 nodes ( 96.06 %) | 3.84 GB | 0.463815 secs 
[2023-08-06 08:49:35.185333: E /ugache/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?2685765->244172
[2023-08-06 08:49:35.185688: E /ugache/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?2685765->366474
[2023-08-06 08:49:35.185743: E /ugache/coll_cache_lib/common.cc:107] too many mem allocated for forcescale?2685765->250445
[2023-08-06 08:49:35.210483: E /ugache/coll_cache_lib/cache_context.cu:2554] Asymm Coll cache (policy: coll_cache_asymm_link) | local 2319291 / 244160499 nodes ( 0.95 %~1.00 %) | remote 7303697 / 244160499 nodes ( 2.99 %) | cpu 234537511 / 244160499 nodes ( 96.06 %) | 3.84 GB | 0.502203 secs 
[2023-08-06 08:49:35.234480: E /ugache/coll_cache_lib/cache_context.cu:2554] Asymm Coll cache (policy: coll_cache_asymm_link) | local 2435320 / 244160499 nodes ( 1.00 %~1.00 %) | remote 7187668 / 244160499 nodes ( 2.94 %) | cpu 234537511 / 244160499 nodes ( 96.06 %) | 3.84 GB | 0.514272 secs 
[2023-08-06 08:49:35.235364: E /ugache/coll_cache_lib/cache_context.cu:2554] Asymm Coll cache (policy: coll_cache_asymm_link) | local 2441593 / 244160499 nodes ( 1.00 %~1.00 %) | remote 7181395 / 244160499 nodes ( 2.94 %) | cpu 234537511 / 244160499 nodes ( 96.06 %) | 3.84 GB | 0.59308 secs 
 mask is 1111111111111111111111111111111111111111111111111111111111110000
 mask is 1111111111111111111111111111111111111111111111110000000000001111
 mask is 1111111111111111111111111111111111110000000000001111111111111111
 mask is 1111111111111111111111110000000000001111111111111111111111111111
[2023-08-06 08:49:35.243815: W /ugache/coll_cache_lib/cache_context.cu:4105] [2023-08-06 08:49:35.243859: W[2023-08-06 08:49:35.243838: W /ugache/coll_cache_lib/cache_context.cu:4105]  before create stream, mem is 9.77 GB
before create stream, mem is 9.77 GB
/ugache/coll_cache_lib/cache_context.cu:4105] before create stream, mem is 9.77 GB
[2023-08-06 08:49:35[2023-08-06 08:49:35.244055[2023-08-06 08:49:35.244073: [2023-08-06 08:49:35.244090: W /ugache/coll_cache_lib/cache_context.cu:4105] after create stream, mem is 9.77 GB.244038: W /ugache/coll_cache_lib/cache_context.cu: W /ugache/coll_cache_lib/cache_context.cu:4105] 
W :4105/ugache/coll_cache_lib/cache_context.cuafter create stream, mem is 9.77 GB
:4105] before create stream, mem is 9.77 GB
] after create stream, mem is 9.77 GB
[2023-08-06 08:49:35.244328: W /ugache/coll_cache_lib/cache_context.cu:4105] after create stream, mem is 9.77 GB
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/scatter_gather.py:9: UserWarning: is_namedtuple is deprecated, please use the python checks instead
  warnings.warn("is_namedtuple is deprecated, please use the python checks instead")
